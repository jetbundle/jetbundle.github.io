<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Section 5.3: Geometric Stochastic Analysis</title>
  <meta name="description" content="Stochastic parallel transport, Malliavin calculus">

  <!-- MathJax - Configured to avoid conflicts with markdown tables -->
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\\[', '\\]']],
        processEscapes: true,
        processEnvironments: true,
        // Configure delimiters to handle \left| and \right| properly
        tags: 'ams',
        autoload: {
          color: [],
          colorv2: ['color'],
          bbox: ['bbox'],
          cancel: ['cancel', 'bcancel', 'xcancel', 'cancelto'],
          enclose: ['enclose', 'cancel', 'color']
        }
      },
      options: {
        skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code', 'table', 'thead', 'tbody', 'tr', 'td', 'th'],
        ignoreHtmlClass: 'no-math',
        processHtmlClass: 'math'
      },
      startup: {
        ready: () => {
          MathJax.startup.defaultReady();
          console.log('MathJax is ready');
          // Fix any remaining placeholder issues
          fixMathPlaceholders();
        }
      }
    };

    // Function to fix any remaining placeholders in math
    function fixMathPlaceholders() {
      const content = document.querySelector('.textbook-content');
      if (!content) return;

      // Find any remaining placeholders and restore them
      const walker = document.createTreeWalker(content, NodeFilter.SHOW_TEXT);
      let node;
      while (node = walker.nextNode()) {
        if (node.textContent.includes('MATH_PIPE_PLACEHOLDER_XYZ123')) {
          node.textContent = node.textContent.replace(/MATH_PIPE_PLACEHOLDER_XYZ123/g, '|');
        }
      }

      // Re-run MathJax if we made changes
      if (window.MathJax && window.MathJax.typesetPromise) {
        window.MathJax.typesetPromise([content]).catch(err => {
          console.log('MathJax re-render after placeholder fix:', err);
        });
      }
    }
  </script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" async></script>

  <!-- Prism.js Syntax Highlighting -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>

  <!-- Textbook CSS -->
  <link rel="stylesheet" href="/assets/css/textbook.css">
</head>
<body class="textbook-body theme-dark">
  <div class="theme-toggle-container">
  <button class="theme-toggle-btn" id="theme-toggle" title="Toggle Theme" aria-label="Toggle dark/light theme">
    <span class="theme-icon-sun">‚òÄ</span>
    <span class="theme-icon-moon">üåô</span>
  </button>
</div>


  <div class="textbook-container">
    <!-- Sidebar Navigation -->
    <nav class="textbook-sidebar">
      <div class="nav-header">
  <h3>Differential Equations</h3>
  <p style="margin: 0 1.5rem 1.5rem; color: var(--text-secondary); font-size: 0.9rem;">2025 Edition</p>
</div>

<nav class="nav-content">
  <ul>
    
    

    
      
        
          <li class="section-item">
            <a href="/diffequations/" >
              0. A Survey of Differential Equations and their Algebraic Geometry
            </a>
          </li>
        
      
    
      
        
        
        <li class="chapter-item">
          <a href="/diffequations/chapter-01/" >
            Chapter 1: Classical Explicit & Quasi-Explicit Arsenal
          </a>
          <ul>
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-01/01-1-exact-methods/" >
              1.1 Exact Methods for Ordinary Differential Equations
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-01/01-2-special-functions/" >
              1.2 Special Functions of Mathematical Physics
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-01/01-3-integral-transforms/" >
              1.3 Integral Transforms
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-01/01-4-linear-pde/" >
              1.4 Classical Linear Partial Differential Equations
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-01/01-5-asymptotic-analysis/" >
              1.5 Asymptotic Analysis
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-01/01-6-perturbation-theory/" >
              1.6 Classical Perturbation Theory
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-01/01-7-renormalization/" >
              1.7 Classical Renormalization & Non-Perturbative Methods
            </a>
          </li>
        
      
    
      
        
          </ul>
        </li>
        
        
        <li class="chapter-item">
          <a href="/diffequations/chapter-02/" >
            Chapter 2: Functional Analysis, Distributions & Weak Solutions
          </a>
          <ul>
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-02/02-1-distributions/" >
              2.1 Distributions & Test Functions
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-02/02-2-sobolev-spaces/" >
              2.2 Sobolev Spaces & Weak Derivatives
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-02/02-3-hilbert-spaces/" >
              2.3 Hilbert Space Theory & Spectral Theorem
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-02/02-4-unbounded-operators/" >
              2.4 Unbounded Operators, Resolvents & Semigroups
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-02/02-5-variational-methods/" >
              2.5 Variational Methods & Lax-Milgram
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-02/02-6-galerkin-methods/" >
              2.6 Galerkin Methods & Finite Elements
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-02/02-7-fredholm-theory/" >
              2.7 Fredholm Theory & Index
            </a>
          </li>
        
      
    
      
        
          </ul>
        </li>
        
        
        <li class="chapter-item">
          <a href="/diffequations/chapter-03/" >
            Chapter 3: Tensor Fields, Conservation Laws & Geometric Formulation
          </a>
          <ul>
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-03/03-1-manifolds-tensors/" >
              3.1 Manifolds, Tensors & Covariant Derivatives
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-03/03-2-conservation-laws/" >
              3.2 Systems of Conservation Laws & Hyperbolicity
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-03/03-3-entropy-solutions/" >
              3.3 Entropy Solutions & Shock Theory
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-03/03-4-exterior-calculus/" >
              3.4 Exterior Calculus & Hodge Decomposition
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-03/03-5-continuum-mechanics/" >
              3.5 Continuum Mechanics & Elasticity
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-03/03-6-geometric-optics/" >
              3.6 Geometric Optics, Rays & Caustics
            </a>
          </li>
        
      
    
      
        
          </ul>
        </li>
        
        
        <li class="chapter-item">
          <a href="/diffequations/chapter-04/" >
            Chapter 4: Symmetry, Lie Theory & Classical Integrability
          </a>
          <ul>
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-04/04-1-lie-symmetries/" >
              4.1 Lie Symmetries & Prolongation
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-04/04-2-noether-theorem/" >
              4.2 Noether's Theorem & Invariant Reduction
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-04/04-3-integrable-systems/" >
              4.3 Completely Integrable Systems
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-04/04-4-lax-pairs/" >
              4.4 Lax Pairs & Zero-Curvature Representations
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-04/04-5-riemann-hilbert/" >
              4.5 Riemann-Hilbert & Inverse Scattering
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-04/04-6-recursion-operators/" >
              4.6 Recursion Operators & Hirota Bilinearization
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-04/04-7-susy-qm/" >
              4.7 Supersymmetric Quantum Mechanics
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-04/04-8-nonlocal-symmetries/" >
              4.8 Nonlocal Symmetries & Potential Systems
            </a>
          </li>
        
      
    
      
        
          </ul>
        </li>
        
        
        <li class="chapter-item">
          <a href="/diffequations/chapter-05/" >
            Chapter 5: Stochastic, Rough, Fractional & Nonlocal Dynamics
          </a>
          <ul>
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-05/05-1-stochastic-calculus/" >
              5.1 Stochastic Calculus Foundations
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-05/05-2-sdes/" >
              5.2 SDEs & Diffusion Processes
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-05/05-3-geometric-stochastic/" class="active">
              5.3 Geometric Stochastic Analysis
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-05/05-4-rough-paths/" >
              5.4 Rough Paths & Controlled Rough Paths
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-05/05-5-fractional-calculus/" >
              5.5 Fractional Calculus & Nonlocal Operators
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-05/05-6-spdes/" >
              5.6 SPDEs & Regularity Structures
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-05/05-7-kinetic-theory/" >
              5.7 Kinetic Theory & Mean-Field Games
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-05/05-8-fractal-geometry/" >
              5.8 Fractal Geometry & Dirichlet Forms
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-05/05-9-susy-stochastics/" >
              5.9 Supersymmetric Theory of Stochastics
            </a>
          </li>
        
      
    
      
        
          </ul>
        </li>
        
        
        <li class="chapter-item">
          <a href="/diffequations/chapter-06/" >
            Chapter 6: Jet Bundles, Exterior Differential Systems & Intrinsic Geometric PDEs
          </a>
          <ul>
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-06/06-1-jet-bundles/" >
              6.1 Jet Bundles & Prolongation
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-06/06-2-formal-integrability/" >
              6.2 Formal Integrability & Spencer Cohomology
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-06/06-3-exterior-systems/" >
              6.3 Exterior Differential Systems & Cartan-K√§hler
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-06/06-4-metric-space/" >
              6.4 The Space of Riemannian Metrics
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-06/06-5-geometric-evolution/" >
              6.5 Geometric Evolution Equations
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-06/06-6-gauge-theories/" >
              6.6 Gauge Theories & Instanton Moduli
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-06/06-7-nonlinear-systems/" >
              6.7 Fully Nonlinear & Overdetermined Systems
            </a>
          </li>
        
      
    
      
        
          </ul>
        </li>
        
        
        <li class="chapter-item">
          <a href="/diffequations/chapter-07/" >
            Chapter 7: Microlocal Analysis, D-Modules & Categorical Resolution
          </a>
          <ul>
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-07/07-1-d-modules/" >
              7.1 D-Modules & Holonomic Systems
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-07/07-2-microlocal-analysis/" >
              7.2 Microlocal Analysis & Wave Front Sets
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-07/07-3-riemann-hilbert/" >
              7.3 Riemann-Hilbert Correspondence
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-07/07-4-fourier-integral/" >
              7.4 Fourier Integral Operators
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-07/07-5-resurgence/" >
              7.5 Resurgence, Borel Summation & Alien Calculus
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-07/07-6-index-theorems/" >
              7.6 Index Theorems & K-Theory
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-07/07-7-noncommutative/" >
              7.7 Noncommutative Geometry
            </a>
          </li>
        
      
    
      
        
          <li class="section-item">
            <a href="/diffequations/chapter-07/07-8-higher-categories/" >
              7.8 Higher Categories, Derived Stacks & TQFT
            </a>
          </li>
        
      
    
      
        
      
    

    
      </ul>
    </li>
    

    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        
          <li class="chapter-item">
            <a href="/diffequations/epilogue/" >
              Epilogue: The Eternal Structure
            </a>
          </li>
        
      
    
  </ul>
</nav>

    </nav>

    <!-- Main Content -->
    <main class="textbook-main">
      <header class="textbook-header">
        <h1>Section 5.3: Geometric Stochastic Analysis</h1>
        <p class="description">Stochastic parallel transport, Malliavin calculus</p>
      </header>

      <article class="textbook-content">
        <h1 id="section-53-geometric-stochastic-analysis">Section 5.3: Geometric Stochastic Analysis</h1>

<h2 id="introduction">Introduction</h2>

<p>Standard stochastic calculus, as developed in the previous modules, relies heavily on the linear vector space structure of $\mathbb{R}^n$. The ability to define increments $\Delta B_t = B_{t+\Delta t} - B_t$ implies the existence of a global coordinate system where vector addition is meaningful. However, physical configuration spaces‚Äîsuch as the configuration space of a rigid body or the phase space of a Hamiltonian system‚Äîare often curved manifolds where no such global linearity exists.</p>

<p>This module lifts the theory of stochastic differential equations from flat space to differentiable manifolds. We discover that the geometric nature of the Stratonovich integral makes it the natural choice for coordinate invariance. Furthermore, we introduce the Malliavin calculus, an infinite-dimensional differential calculus on the Wiener space itself, which provides the rigorous link between the algebraic structure of vector fields (Lie brackets) and the analytic regularity of solution densities (H√∂rmander‚Äôs theorem).</p>

<h2 id="mathematical-content">Mathematical Content</h2>

<h3 id="stochastic-differential-geometry">Stochastic Differential Geometry</h3>

<p>To formulate a stochastic differential equation on a smooth manifold $M$ of dimension $d$, we must address the transformation properties of stochastic integrals. Recall from Section 5.1 that the It√¥ chain rule involves a second-order term involving the Hessian. On a manifold, the Hessian is not a tensorial object unless one specifies a connection (e.g., the Levi-Civita connection). Consequently, It√¥ equations are not invariant under coordinate transformations unless the stochastic term is coupled intrinsically to the geometry.</p>

<p>Conversely, the Stratonovich chain rule satisfies the classical Leibniz rule of ordinary calculus:</p>

\[d(f(X_t)) = f'(X_t) \circ dX_t\]

<p>This invariance suggests that stochastic differential geometry is best formulated using Stratonovich integration. We consider an SDE on $M$ driven by an $m$-dimensional Brownian motion $B_t = (B^1_t, \dots, B^m_t)$ in $\mathbb{R}^m$. Let $V_0$ be a vector field representing the drift, and let $V_1, \dots, V_m$ be vector fields representing the diffusion coefficients. In local coordinates, the intrinsic equation is written as:</p>

\[dX_t = V_0(X_t) dt + \sum_{k=1}^m V_k(X_t) \circ dB^k_t\]

<p>This formulation ensures that the solution $X_t$ is independent of the chart used to describe it.</p>

<h4 id="stochastic-parallel-transport-and-development">Stochastic Parallel Transport and Development</h4>

<p>To analyze these processes without relying on local charts, we utilize the frame bundle $OM$ (the bundle of orthonormal bases of the tangent spaces). We lift the Brownian motion from the flat tangent space $T_{x_0}M \cong \mathbb{R}^d$ to a path on the manifold via the <strong>Eells-Elworthy-Malliavin construction</strong>.</p>

<p>This is conceptualized as ‚Äúrolling without slipping.‚Äù We define the <strong>stochastic development</strong> map, which transforms a Brownian motion in $\mathbb{R}^d$ into a diffusion on $M$. Let $u_t \in O_{X_t}M$ be an orthonormal frame at $X_t$. The horizontal lift of the process is defined by solving a differential equation on the frame bundle using the canonical horizontal vector fields $H_i$:</p>

\[du_t = \sum_{i=1}^d H_i(u_t) \circ dB^i_t\]

<p>The projection $\pi(u_t) = X_t$ defines Brownian motion on the manifold (specifically, the diffusion generated by the Laplace-Beltrami operator $\Delta_M$). Simultaneously, $u_t$ defines <strong>stochastic parallel transport</strong> along the rough path $X_t$. This construction allows us to compare tangent vectors at different times $t$ and $s$ along a non-differentiable trajectory, extending the Levi-Civita connection to the stochastic setting.</p>

<h3 id="malliavin-calculus-variations-on-wiener-space">Malliavin Calculus: Variations on Wiener Space</h3>

<p>While stochastic geometry handles the curvature of the state space, Malliavin calculus addresses the geometry of the probability space itself. It can be viewed as an infinite-dimensional calculus of variations where the ‚Äúvariable‚Äù is the Brownian path $\omega \in \Omega = C_0([0,T]; \mathbb{R}^m)$.</p>

<h4 id="the-malliavin-derivative">The Malliavin Derivative</h4>

<p>We seek to differentiate a random variable $F(\omega)$ with respect to variations in the path $\omega$. Let $H = L^2([0,T]; \mathbb{R}^m)$ be the Cameron-Martin space. For a ‚Äúcylindrical‚Äù functional of the form $F = f(B(t_1), \dots, B(t_n))$ with $f \in C_p^\infty(\mathbb{R}^{n \times m})$, the Malliavin derivative $DF$ is the $H$-valued random variable defined by:</p>

\[D_t F = \sum_{i=1}^n \partial_i f(B(t_1), \dots, B(t_n)) \mathbf{1}_{[0, t_i]}(t)\]

<p>Here, $D_t F$ represents the gradient of the functional in the direction of the noise at time $t$. We define the Sobolev space $\mathbb{D}^{1,p}$ as the completion of cylindrical functionals under the norm:</p>

\[\|F\|_{1,p} = \left( \mathbb{E}[|F|^p] + \mathbb{E}[\|DF\|_H^p] \right)^{1/p}\]

<h4 id="integration-by-parts-and-the-skorokhod-integral">Integration by Parts and the Skorokhod Integral</h4>

<p>The operator $D: \mathbb{D}^{1,2} \to L^2(\Omega; H)$ is unbounded but closable. Its adjoint, denoted by $\delta$, is called the divergence operator or the <strong>Skorokhod integral</strong>. It generalizes the It√¥ integral to integrands that are not adapted to the filtration. The fundamental integration by parts formula on Wiener space relates these operators:</p>

\[\mathbb{E}[\langle DF, u \rangle_H] = \mathbb{E}[F \delta(u)]\]

<p>for any $F \in \mathbb{D}^{1,2}$ and any process $u$ in the domain of $\delta$. This formula is the stochastic analog of the divergence theorem and is the engine driving the regularity results of the theory.</p>

<h4 id="the-clark-ocone-formula">The Clark-Ocone Formula</h4>

<p>A pivotal result in this calculus is the explicit representation of the martingale in the It√¥ representation theorem. For any $F \in \mathbb{D}^{1,2}$, we have:</p>

\[F = \mathbb{E}[F] + \int_0^T \mathbb{E}[D_t F \mid \mathcal{F}_t] dB_t\]

<p>This links the derivative of a functional to the integrand required to replicate it, a result with profound implications for hedging in mathematical finance.</p>

<h3 id="h√∂rmanders-theorem-and-hypoellipticity">H√∂rmander‚Äôs Theorem and Hypoellipticity</h3>

<p>The crowning achievement of geometric stochastic analysis is the probabilistic proof of H√∂rmander‚Äôs theorem. Consider the SDE on $\mathbb{R}^d$ (or a manifold):</p>

\[dX_t = V_0(X_t) dt + \sum_{k=1}^m V_k(X_t) \circ dB^k_t\]

<p>The generator of this diffusion is the second-order partial differential operator $\mathcal{L} = V_0 + \frac{1}{2}\sum_{k=1}^m V_k^2$. If the diffusion coefficients are non-degenerate (elliptic case), classical theory ensures the transition density $p_t(x, y)$ is smooth. However, if the noise acts only on a subspace, ellipticity fails.</p>

<h4 id="the-lie-algebra-condition">The Lie Algebra Condition</h4>

<p>The operator $\mathcal{L}$ is <strong>hypoelliptic</strong> if the vector fields ${V_0, V_1, \dots, V_m}$ and their iterated Lie brackets $[V_i, V_j], [V_i, [V_j, V_k]], \dots$ span the tangent space $\mathbb{R}^d$ at every point. Geometrically, this means that while the noise does not push in every direction directly, it can reach any direction through the non-commutativity of the flows.</p>

<h4 id="the-malliavin-covariance-matrix">The Malliavin Covariance Matrix</h4>

<p>To prove that the law of $X_t$ admits a smooth density, we analyze the Malliavin covariance matrix $\sigma_{X_t} \in \mathbb{R}^{d \times d}$, defined by:</p>

\[\sigma_{X_t}^{ij} = \langle D X_t^i, D X_t^j \rangle_H\]

<p>The non-degeneracy of this matrix implies the smoothness of the density. Using the integration by parts formula on Wiener space, one can show that if the Lie algebra condition holds, the matrix $\sigma_{X_t}$ is invertible almost surely, and the inverse has finite moments of all orders. This guarantees that $X_t$ has a density $p_t(x, \cdot) \in C^\infty$, bridging the algebraic geometry of vector fields with the functional analysis of partial differential equations.</p>

<h2 id="complete-examples">Complete Examples</h2>

<h3 id="example-531-canonical-casebrownian-motion-on-the-circle-s1">Example 5.3.1: Canonical Case‚ÄîBrownian Motion on the Circle ($S^1$)</h3>

<p><strong>Problem:</strong> Consider Brownian motion on the circle $S^1 = \mathbb{R}/2\pi\mathbb{Z}$ driven by a single Brownian motion:</p>

\[d\theta_t = \sigma \circ dB_t\]

<p><strong>Step-by-Step Solution:</strong></p>

<ol>
  <li><strong>Local Coordinate Representation:</strong>
In local coordinates $\theta \in [-\pi, \pi)$, the Stratonovich SDE is:</li>
</ol>

\[d\theta_t = \sigma dB_t \quad (\text{Stratonovich})\]

<ol>
  <li><strong>Verify Coordinate Invariance:</strong>
Consider coordinate change $\phi = 2\theta$. Then $d\phi_t = 2 d\theta_t = 2\sigma dB_t$.</li>
</ol>

<p>The generator in $\theta$-coordinates:</p>

\[\mathcal{L}_\theta = \frac{\sigma^2}{2} \frac{\partial^2}{\partial \theta^2}\]

<p>In $\phi$-coordinates:</p>

\[\mathcal{L}_\phi = \frac{(2\sigma)^2}{2} \frac{\partial^2}{\partial \phi^2} = 2\sigma^2 \frac{\partial^2}{\partial \phi^2}\]

<p>Chain rule verification: $\frac{\partial}{\partial \phi} = \frac{1}{2} \frac{\partial}{\partial \theta}$, so:</p>

\[\mathcal{L}_\phi = 2\sigma^2 \left(\frac{1}{2}\right)^2 \frac{\partial^2}{\partial \theta^2} = \frac{\sigma^2}{2} \frac{\partial^2}{\partial \theta^2}\]

<p>The generator transforms correctly, confirming coordinate invariance.</p>

<ol>
  <li><strong>Stochastic Development (Frame Bundle):</strong>
The frame bundle $OS^1$ at point $\theta$ consists of orthonormal bases ${e_1(\theta)}$. The horizontal lift is:</li>
</ol>

\[de_1(\theta_t) = H_1(e_1) \circ dB_t\]

<p>where $H_1$ is the horizontal vector field. For $S^1$ with metric $ds^2 = d\theta^2$:</p>

\[H_1 = \frac{\partial}{\partial \theta}\]

<p>The parallel transport satisfies:</p>

\[\nabla_{\frac{\partial}{\partial \theta}} e_1 = 0 \implies e_1(\theta_t) = e_1(0)\]

<p><strong>Result:</strong> Parallel transport on $S^1$ is path-independent (flat connection).</p>

<ol>
  <li><strong>Transition Density:</strong>
The heat kernel on $S^1$ is:</li>
</ol>

\[p_t(\theta, \phi) = \frac{1}{2\pi} + \frac{1}{\pi} \sum_{k=1}^\infty \cos(k(\theta-\phi)) e^{-k^2 \sigma^2 t/2}\]

<h3 id="example-532-physical-applicationfoucault-pendulum">Example 5.3.2: Physical Application‚ÄîFoucault Pendulum</h3>

<p><strong>Problem:</strong> Model the stochastic Foucault pendulum on $S^2$. The configuration space is the sphere with coordinates $(\theta, \phi)$ where $\theta \in [0,\pi]$ (colatitude) and $\phi \in [0, 2\pi)$ (longitude).</p>

<p><strong>SDE on $S^2$:</strong></p>

\[\begin{cases}
d\theta_t = \sigma_1 \circ dB^1_t \\
d\phi_t = \sin^{-1}(\theta_t) \sigma_2 \circ dB^2_t
\end{cases}\]

<p><strong>Step-by-Step Solution:</strong></p>

<ol>
  <li><strong>Metric and Volume Form:</strong>
Riemannian metric: $ds^2 = d\theta^2 + \sin^2\theta d\phi^2$</li>
</ol>

<p>Volume form: $dV = \sin\theta d\theta d\phi$</p>

<ol>
  <li><strong>Generator Computation:</strong>
The diffusion vector fields are:</li>
</ol>

\[V_1 = \frac{\partial}{\partial \theta}, \quad V_2 = \sin^{-1}(\theta) \frac{\partial}{\partial \phi}\]

<p>The generator is:</p>

\[\mathcal{L} = \frac{1}{2} \left( V_1^2 + V_2^2 \right) = \frac{1}{2} \frac{\partial^2}{\partial \theta^2} + \frac{1}{2} \frac{\partial^2}{\partial \phi^2}\]

<p><strong>Remark:</strong> The generator is exactly the Laplace-Beltrami operator $\Delta_{S^2}$!</p>

<ol>
  <li><strong>Malliavin Derivative Computation:</strong>
Consider $F = \cos\theta_T$. Compute $D_t F$:</li>
</ol>

\[D_t \cos\theta_T = -\sin\theta_T \cdot D_t \theta_T\]

<p>The process $Y_t = D_t \theta_s$ for $s \geq t$ satisfies:</p>

\[dY_u = 0, \quad Y_t = 1 \implies Y_u = 1 \quad (u \geq t)\]

<p>Thus:</p>

\[D_t F = -\sin\theta_T \cdot \mathbf{1}_{[0,T]}(t)\]

<ol>
  <li><strong>Malliavin Covariance Matrix:</strong>
\(\sigma_F = \int_0^T |D_t F|_H^2 dt = \int_0^T \sin^2\theta_T dt = T \sin^2\theta_T\)</li>
</ol>

<p>The density exists since $\mathbb{E}[\sigma_F^{-1}] &lt; \infty$ almost surely.</p>

<ol>
  <li><strong>Physical Interpretation:</strong>
The noise in $\phi$ is state-dependent ($\propto 1/\sin\theta$), vanishing at the poles. Yet H√∂rmander‚Äôs condition holds:</li>
</ol>

\[[V_1, V_2] = \frac{\partial}{\partial \phi} \cos\theta\]

<p>The Lie brackets span $T_p S^2$ everywhere except poles, ensuring smooth densities.</p>

<h3 id="example-533-advanced-demonstrationhypoellipticity-on-heisenberg-group">Example 5.3.3: Advanced Demonstration‚ÄîHypoellipticity on Heisenberg Group</h3>

<p><strong>Problem:</strong> Consider the Heisenberg group $\mathbb{H}^3 = \mathbb{R}^3$ with group law:</p>

\[(x,y,z) \cdot (x',y',z') = \left(x+x', y+y', z+z' + \frac{1}{2}(xy'-x'y')\right)\]

<p><strong>Left-invariant vector fields:</strong></p>

\[X = \frac{\partial}{\partial x} - \frac{y}{2} \frac{\partial}{\partial z}, \quad Y = \frac{\partial}{\partial y} + \frac{x}{2} \frac{\partial}{\partial z}, \quad Z = \frac{\partial}{\partial z}\]

<p><strong>SDE:</strong></p>

\[dX_t = X(X_t) \circ dB^1_t + Y(X_t) \circ dB^2_t\]

<p><strong>Step-by-Step Solution:</strong></p>

<ol>
  <li><strong>Lie Bracket Computation:</strong>
\([X, Y] = Z, \quad [X, Z] = [Y, Z] = 0\)</li>
</ol>

<p><strong>H√∂rmander Condition:</strong> ${X, Y, [X,Y]} = {X, Y, Z}$ spans $\mathbb{R}^3$.</p>

<ol>
  <li><strong>Malliavin Derivative System:</strong>
Let $X_t = (x_t, y_t, z_t)$. The Malliavin derivatives $J_t = D_t X_s$ satisfy:</li>
</ol>

\[\begin{cases}
dJ^x_u = 0, &amp; J^x_t = 1 \\
dJ^y_u = 0, &amp; J^y_t = 0 \\
dJ^z_u = -\frac{y_u}{2} dJ^x_u + \frac{x_u}{2} dJ^y_u, &amp; J^z_t = 0
\end{cases}\]

<p><strong>Solution:</strong> $J^x_u = 1$, $J^y_u = 0$, $J^z_u = \int_t^u \left(\frac{x_r}{2}\right)‚Äô dr = 0$</p>

<ol>
  <li><strong>Covariance Matrix:</strong>
The Malliavin covariance matrix at time $T$:</li>
</ol>

\[\sigma_T = \int_0^T J_t J_t^T dt = \begin{pmatrix}
T &amp; 0 &amp; 0 \\
0 &amp; T &amp; 0 \\
0 &amp; 0 &amp; \int_0^T \int_t^T [X_r, Y_r] dr dt
\end{pmatrix}\]

<p>Compute the $(3,3)$ entry:</p>

\[\int_0^T \int_t^T \langle [X_r, Y_r], Z \rangle dr dt = \int_0^T \int_t^T 1 \, dr \, dt = \frac{T^2}{2}\]

<ol>
  <li><strong>Non-degeneracy Proof:</strong>
\(\det \sigma_T = T \cdot T \cdot \frac{T^2}{2} = \frac{T^4}{2} &gt; 0\)</li>
</ol>

<p>The matrix is invertible for all $T &gt; 0$, proving hypoellipticity.</p>

<ol>
  <li><strong>Explicit Density (Small Time):</strong>
The small-time asymptotic for the heat kernel is:</li>
</ol>

\[p_t(x,y,z) \sim (4\pi t)^{-3/2} \exp\left(-\frac{x^2 + y^2}{4t} - \frac{|z - \frac{xy}{2}|^2}{t^3}\right)\]

<p>The non-Gaussian $z$-component reflects the non-commutativity.</p>

<h3 id="example-534-malliavin-calculusclark-ocone-formula-verification">Example 5.3.4: Malliavin Calculus‚ÄîClark-Ocone Formula Verification</h3>

<p><strong>Problem:</strong> Verify Clark-Ocone for $F = B_T^2$ where $B_t$ is 1D Brownian motion.</p>

<p><strong>Step-by-Step Solution:</strong></p>

<ol>
  <li>
    <p><strong>Compute Malliavin Derivative:</strong>
\(D_t F = D_t (B_T^2) = 2 B_T D_t B_T = 2 B_T \mathbf{1}_{[0,T]}(t)\)</p>
  </li>
  <li>
    <p><strong>Conditional Expectation:</strong>
\(\mathbb{E}[D_t F \mid \mathcal{F}_t] = 2 \mathbb{E}[B_T \mid \mathcal{F}_t] = 2 B_t\)</p>
  </li>
  <li>
    <p><strong>Clark-Ocone Formula:</strong>
\(F = \mathbb{E}[F] + \int_0^T \mathbb{E}[D_t F \mid \mathcal{F}_t] dB_t\)</p>
  </li>
</ol>

<p>Compute: $\mathbb{E}[B_T^2] = T$</p>

\[B_T^2 = T + \int_0^T 2 B_t dB_t\]

<ol>
  <li><strong>Verification by It√¥ Formula:</strong>
\(d(B_t^2) = 2 B_t dB_t + dt\)</li>
</ol>

<p>Integrate: $B_T^2 = B_0^2 + \int_0^T 2 B_t dB_t + T = T + \int_0^T 2 B_t dB_t$</p>

<p><strong>Result:</strong> Exact match!</p>

<h3 id="example-535-financial-applicationasian-option">Example 5.3.5: Financial Application‚ÄîAsian Option</h3>

<p><strong>Problem:</strong> Price an Asian call option $F = \max\left(\frac{1}{T} \int_0^T S_t dt - K, 0\right)$.</p>

<p><strong>Step-by-Step Solution:</strong></p>

<ol>
  <li>
    <p><strong>Geometric Brownian Motion:</strong>
\(dS_t = \mu S_t dt + \sigma S_t dB_t, \quad S_0 = S\)</p>
  </li>
  <li>
    <p><strong>Average Process:</strong>
Let $A_t = \frac{1}{t} \int_0^t S_u du$. Then:</p>
  </li>
</ol>

\[dA_t = \frac{S_t - A_t}{t} dt\]

<ol>
  <li><strong>Malliavin Derivative:</strong>
\(D_s A_T = \frac{1}{T} D_s \int_0^T S_u du = \frac{1}{T} \int_s^T D_s S_u du\)</li>
</ol>

<p>The process $Y_u = D_s S_u$ satisfies:</p>

\[dY_u = \mu Y_u du + \sigma Y_u dB_u, \quad Y_s = S_s\]

<p><strong>Solution:</strong> $Y_u = S_u$ for $u \geq s$.</p>

<ol>
  <li><strong>Clark-Ocone Representation:</strong>
\(F = \mathbb{E}[F] + \int_0^T \mathbb{E}[D_t F \mid \mathcal{F}_t] dB_t\)</li>
</ol>

<p>The hedging strategy is $\pi_t = \mathbb{E}[D_t F \mid \mathcal{F}_t]$.</p>

<h3 id="example-536-advancedintegration-by-parts-on-manifolds">Example 5.3.6: Advanced‚ÄîIntegration by Parts on Manifolds</h3>

<p><strong>Problem:</strong> Prove integration by parts for $F = f(X_T)$ where $X_t$ solves SDE on manifold $M$.</p>

<p><strong>Step-by-Step Solution:</strong></p>

<ol>
  <li><strong>Local Coordinate Formula:</strong>
For $f \in C^\infty_p(M)$:</li>
</ol>

\[\mathbb{E}[\langle DF, u \rangle_H] = \mathbb{E}[F \delta(u)]\]

<ol>
  <li><strong>Global Extension:</strong>
Lift to frame bundle $OM$. Define $DF$ using horizontal vector fields $H_i$:</li>
</ol>

\[D_t f(X_s) = \sum_{i=1}^d \langle H_i(f), u_t \rangle \mathbf{1}_{[0,s]}(t)\]

<ol>
  <li><strong>Divergence Theorem:</strong>
The Skorokhod integral $\delta(u)$ satisfies:</li>
</ol>

\[\mathbb{E}[f(X_T) \delta(u)] = \mathbb{E}\left[\int_M f(x) \operatorname{div}_M(u_T(x)) d\mu(x)\right]\]

<h3 id="example-537-h√∂rmanders-theoremexplicit-lie-bracket-analysis">Example 5.3.7: H√∂rmander‚Äôs Theorem‚ÄîExplicit Lie Bracket Analysis</h3>

<p><strong>Problem:</strong> $dX_t = Y(X_t) dt + X(X_t) \circ dB_t$ where:</p>

\[X = \frac{\partial}{\partial x}, \quad Y = -y \frac{\partial}{\partial x} + \frac{\partial}{\partial y}\]

<p><strong>Step-by-Step Solution:</strong></p>

<ol>
  <li><strong>Lie Brackets:</strong>
\([Y, X] = \frac{\partial}{\partial x} + y \frac{\partial}{\partial x} = (1+y) \frac{\partial}{\partial x}\)</li>
</ol>

<p>The span is ${(1+y)\partial_x, \partial_y}$. Non-degenerate except $y = -1$.</p>

<ol>
  <li><strong>Malliavin Matrix:</strong>
\(J_t = \begin{pmatrix} D_t x_s &amp; D_t y_s \\ 0 &amp; 1 \end{pmatrix}\)</li>
</ol>

<p>Compute: $D_t x_s = \int_t^s -y_r dr$, $D_t y_s = 1$</p>

\[\sigma_T = \int_0^T \begin{pmatrix} \left(\int_t^T -y_r dr\right)^2 &amp; \int_t^T -y_r dr \\ \int_t^T -y_r dr &amp; T \end{pmatrix} dt\]

<h3 id="example-538-physical-applicationstochastic-rigid-body">Example 5.3.8: Physical Application‚ÄîStochastic Rigid Body</h3>

<p><strong>Problem:</strong> Angular velocity $\omega \in \mathbb{R}^3$ with:</p>

\[d\omega_t = \omega_t \times I\omega_t dt + \sum_{i=1}^3 e_i \circ dB^i_t\]

<p><strong>Vector fields:</strong> $V_0 = \omega \times I\omega$, $V_i = e_i$.</p>

<p><strong>Step-by-Step Solution:</strong></p>

<ol>
  <li><strong>Lie Algebra $\mathfrak{so}(3)$:</strong>
\([V_i, V_j] = e_i \times e_j\)</li>
</ol>

<p>The Lie algebra generated is all of $\mathbb{R}^3$, ensuring hypoellipticity.</p>

<h3 id="example-539-failure-case-analysis">Example 5.3.9: Failure Case Analysis</h3>

<p><strong>Problem:</strong> Sub-Riemannian geometry where noise acts only on first coordinate:</p>

\[dX_t = Y(X_t) dt + \frac{\partial}{\partial x_1}(X_t) \circ dB_t\]

<p><strong>Counterexample:</strong> If $[Y, \partial_{x_1}] = 0$, then span is only 1-dimensional. The density is singular along characteristics.</p>

<h2 id="references">References</h2>

<ul>
  <li>Elworthy, K. D. (1982). <em>Stochastic Differential Equations on Manifolds</em>. Cambridge University Press.</li>
  <li>H√∂rmander, L. (1967). ‚ÄúHypoelliptic second order differential equations‚Äù. <em>Acta Mathematica</em>.</li>
  <li>Hsu, E. P. (2002). <em>Stochastic Analysis on Manifolds</em>. American Mathematical Society.</li>
  <li>Ikeda, N., &amp; Watanabe, S. (1989). <em>Stochastic Differential Equations and Diffusion Processes</em>. North-Holland.</li>
  <li>Nualart, D. (2006). <em>The Malliavin Calculus and Related Topics</em>. Springer.</li>
</ul>

<h2 id="navigation">Navigation</h2>

<nav class="page-navigation">
  <div class="nav-previous">
    
      <a href="/diffequations/chapter-05/05-2-sdes/" class="nav-link">
        <span class="nav-arrow">‚Üê</span>
        <span class="nav-text">
          <span class="nav-label">Previous</span>
          <span class="nav-title">Section 5.2: SDEs &amp; Diffusion Processes</span>
        </span>
      </a>
    
  </div>
  <div class="nav-next">
    
      <a href="/diffequations/chapter-05/05-4-rough-paths/" class="nav-link">
        <span class="nav-text">
          <span class="nav-label">Next</span>
          <span class="nav-title">Section 5.4: Rough Paths &amp; Controlled Rough Paths</span>
        </span>
        <span class="nav-arrow">‚Üí</span>
      </a>
    
  </div>
</nav>

<hr />

<h2 id="related-sections">Related Sections</h2>

<ul>
  <li><a href="/diffequations/chapter-05/05-2-sdes/">Previous Section: 5.2 SDEs &amp; Diffusion Processes</a></li>
  <li><a href="/diffequations/chapter-05/05-4-rough-paths/">Next Section: 5.4 Rough Paths &amp; Controlled Rough Paths</a></li>
  <li><a href="/diffequations/chapter-05/">Chapter Index</a></li>
  <li><a href="/diffequations/">Full Table of Contents</a></li>
</ul>

      </article>
    </main>
  </div>

  <!-- Pyodide & Plotly (Load asynchronously) -->
  <script src="https://cdn.jsdelivr.net/pyodide/v0.24.1/full/pyodide.js"></script>
  <script src="https://cdn.plot.ly/plotly-2.27.0.min.js" charset="utf-8"></script>

  <!-- Textbook JavaScript -->
  <script src="/assets/js/theme-manager.js"></script>
  <script src="/assets/js/textbook-engine.js"></script>
  <script src="/assets/js/widget-engine.js"></script>
  <script src="/assets/js/code-toggle.js"></script>
</body>
</html>
