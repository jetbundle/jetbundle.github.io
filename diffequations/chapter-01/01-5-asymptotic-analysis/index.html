<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Section 1.5: Asymptotic Analysis</title>
    <meta name="description"
        content="When exact solutions are impossible, we extract asymptotic behavior from critical points — but the expansion jumps discontinuously across Stokes lines.">

    <!-- KaTeX – canonical loading -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {delimiters: [{left:'$$',right:'$$',display:true},{left:'$',right:'$',display:false}], throwOnError:false});">
        </script>

    <link rel="stylesheet" href="/diffequations/styles.css">
    <script src="/diffequations/navigation-data.js"></script>
    <script src="/diffequations/navigation.js"></script>
    <!-- Manifold background only on main index -->
</head>

<body>
    <main>
        <!-- 1. HOOK -->
        <header class="hook">
            <h1>Section 1.5: Asymptotic Analysis</h1>
            <p class="hook-text">
                When exact solutions are impossible, we extract asymptotic behavior from critical points: local geometry determines global behavior in the limit.
            </p>
            <p class="hook-subtitle">
                But the asymptotic expansion jumps discontinuously across Stokes lines, encoding topological information that local series cannot capture.
            </p>
        </header>

        <!-- 2. DESCRIPTION -->
        <p class="description">
            Laplace's method, stationary phase, WKB approximation, and the Stokes phenomenon — where local truth reveals global structure through discontinuous jumps.
        </p>

        <article>

            <!-- 3. NARRATIVE INTRODUCTION (3 paragraphs) -->
            <section class="narrative-intro">
                <p>Acknowledging that exact solutions are rare, we turn to approximation in limits. Laplace's method reveals that integrals with large parameters are dominated by critical points—the global maximum of the phase function determines the asymptotic behavior. Stationary phase shows that oscillatory integrals cancel everywhere except near stationary points, where interference is constructive. These methods extract "local truth"—accurate behavior at infinity or zero—from the geometry of the integrand.</p>
                <p>The WKB approximation connects wave mechanics to classical ray trajectories. In the semiclassical limit, quantum wavefunctions become classical actions, and the Schrödinger equation reduces to the Hamilton–Jacobi equation. But this connection is not global: near turning points, where the classical momentum vanishes, WKB breaks down. The solution must be matched to Airy functions, introducing a $\pi/4$ phase shift that encodes the topology of the classical trajectory.</p>
                <p>This local-global tension reaches its crisis in the Stokes phenomenon. Asymptotic expansions are sectorial: they hold only within wedges bounded by Stokes lines. Crossing a Stokes line activates subdominant exponentials with discontinuous multipliers. The expansion's form jumps, encoding global analytic structure that cannot be captured by any local series. This reveals that asymptotic analysis is not merely approximation—it is a topological tool that extracts geometric information from divergent series.</p>
            </section>

            <!-- CORE CONTENT WITH SEMANTIC BLOCKS & INTERMEDIATE CLIFFHANGERS -->

            <section>
                <h2>Laplace's Method: Dominance of Critical Points</h2>

                <div class="theorem">
                    <p><strong>Laplace's Method:</strong> For integrals with a large parameter,</p>
                    $$I(M)=\int_{a}^{b}g(x)e^{M h(x)}\,dx,\qquad M\to\infty,$$
                    <p>the main contribution arises near the global maximum of $h$. If $h$ has a unique interior maximum at $x_{0}$ with $h''(x_{0})<0$, Taylor expansion gives</p>
                    $$I(M)\sim g(x_{0})e^{M h(x_{0})}\sqrt{\frac{2\pi}{M\vert h''(x_{0}) \vert}}.$$
                    <p>When the maximum occurs at an endpoint with $h'(a)\neq 0$, the scaling changes to $I(M)\sim g(a)e^{M h(a)}/(M\vert h'(a) \vert)$, illustrating the discontinuous dependence on critical-point geometry.</p>
                </div>

                <div class="example">
                    <p><strong>Endpoint Laplace Method</strong></p>
                    <p>Estimate $I(M)=\int_{0}^{1}e^{M(\ln x - x)}\,dx$ as $M\to\infty$.</p>
                    <p>The phase $h(x)=\ln x - x$ attains its maximum at $x=1$, an endpoint with $h'(1)=0$ and $h''(1)=-1$. Setting $x=1-t$ yields $h(1-t)\approx -t-\tfrac{t^{2}}{2}$, so</p>
                    $$I(M)\approx \int_{0}^{\infty}e^{-M t-M t^{2}/2}\,dt\sim \frac{1}{M}.$$
                    <p>This matches the asymptotic of the exponential integral $E_{1}(M)$.</p>
                    <p>Endpoint maxima create different scaling laws than interior maxima, reflecting the geometric constraint that the integration domain terminates at the critical point.</p>
                </div>

                <div class="example">
                    <p><strong>Partition Function via Laplace Method</strong></p>
                    <p>Evaluate $Z(\beta)=\int_{-\infty}^{\infty}e^{-\beta (x^{4}-2x^{2})}\,dx$ for $\beta\to\infty$.</p>
                    <p>The potential $V(x)=x^{4}-2x^{2}$ has minima at $x=\pm 1$ with $V''(\pm 1)=8$. Each contributes</p>
                    $$Z(\beta)\sim 2 e^{\beta}\sqrt{\frac{2\pi}{\beta \cdot 8}}=e^{\beta}\sqrt{\frac{\pi}{2\beta}}.$$
                    <p>The free energy $F=-(1/\beta)\ln Z$ approaches $-1+\tfrac{1}{2\beta}\ln(\pi/2\beta)$, revealing the ground-state energy plus thermal corrections.</p>
                    <p>Multiple critical points contribute independently in the limit, with each creating its own Gaussian peak. The partition function becomes a sum over these localized contributions, revealing the connection between statistical mechanics and critical-point analysis.</p>
                </div>

                <!-- VICTORY WIDGET: Laplace's Method -->
                <div class="widget-module victory-widget widget-continuous" id="laplace-method-1-5">
                    <div class="module-header">
                        <h3>Interactive: Laplace's Method — Dominance of Critical Points</h3>
                        <div class="widget-controls">
                            <div class="widget-control">
                                <label>Parameter $M$</label>
                                <input type="range" class="widget-slider" data-param="M" min="1" max="50" step="1"
                                    value="10">
                                <span class="widget-value" data-param="M">10</span>
                            </div>
                        </div>
                        <button class="run-button widget-run">Run</button>
                    </div>
                    <div class="plotly-container widget-output"></div>
                    <div class="code-block hidden">
                        <pre><code class="language-python">import numpy as np

# Parameters from widgets (injected automatically)
# M_val will be injected here by widget engine

# Laplace's method: I(M) = ∫ g(x) e^{M h(x)} dx
# Example: h(x) = -x^2, g(x) = 1, on [-3, 3]
# Maximum at x = 0, h(0) = 0, h''(0) = -2
# Asymptotic: I(M) ~ g(0) e^{M h(0)} √(2π/(M|h''(0)|)) = √(π/M)

x = np.linspace(-3, 3, 1000)
h_x = -x**2
g_x = np.ones_like(x)

# Compute integrand
integrand = g_x * np.exp(M_val * h_x)

# Numerical integration
I_numerical = float(np.trapz(integrand, x))

# Asymptotic formula (for large M)
I_asymptotic = float(np.sqrt(np.pi / M_val))

# Gaussian approximation near maximum
# Near x = 0: h(x) ≈ h(0) + (1/2) h''(0) x^2 = -x^2
# So integrand ≈ e^{-M x^2}
# Width of Gaussian: σ = 1/√(2M)
sigma = 1.0 / np.sqrt(2 * M_val)
x_gauss = np.linspace(-3*sigma, 3*sigma, 200)
gauss_approx = np.exp(-M_val * x_gauss**2)

# Contribution from different regions
# Most contribution comes from |x| < 3σ
x_contrib = np.linspace(-3*sigma, 3*sigma, 500)
integrand_contrib = np.exp(-M_val * x_contrib**2)
I_contrib = float(np.trapz(integrand_contrib, x_contrib))

# RIGHT PLOT: Comparison of numerical vs asymptotic for range of M
M_range = np.linspace(1, 50, 50)
I_num_range = []
I_asym_range = []
I_error_range = []

for M in M_range:
    x_temp = np.linspace(-3, 3, 1000)
    integrand_temp = np.exp(-M * x_temp**2)
    I_num = float(np.trapz(integrand_temp, x_temp))
    I_asym = float(np.sqrt(np.pi / M))
    I_num_range.append(I_num)
    I_asym_range.append(I_asym)
    I_error_range.append(abs(I_num - I_asym) / I_num * 100)

traces = []

# LEFT PLOT: Integrand and Gaussian approximation
traces.append({
    'x': x.tolist(),
    'y': integrand.tolist(),
    'mode': 'lines',
    'name': f'Integrand: e^{{{M_val:.0f} h(x)}}',
    'line': {'color': '#4caf50', 'width': 3},
    'xaxis': 'x',
    'yaxis': 'y'
})

traces.append({
    'x': x_gauss.tolist(),
    'y': gauss_approx.tolist(),
    'mode': 'lines',
    'name': f'Gaussian approx (σ = {sigma:.3f})',
    'line': {'color': '#ffa500', 'width': 2, 'dash': 'dot'},
    'xaxis': 'x',
    'yaxis': 'y'
})

# Mark the critical point
traces.append({
    'x': [0.0],
    'y': [1.0],
    'mode': 'markers',
    'name': 'Maximum at x = 0',
    'marker': {'color': '#ff6b6b', 'size': 15, 'symbol': 'x', 'line': {'width': 2}},
    'xaxis': 'x',
    'yaxis': 'y'
})

# Mark contribution region
traces.append({
    'x': [-3*sigma, -3*sigma, 3*sigma, 3*sigma, -3*sigma],
    'y': [0, 1.2, 1.2, 0, 0],
    'mode': 'lines',
    'name': f'Contribution region (|x| < 3σ)',
    'line': {'color': '#58a6ff', 'width': 2, 'dash': 'dash'},
    'fill': 'toself',
    'fillcolor': 'rgba(88, 166, 255, 0.1)',
    'xaxis': 'x',
    'yaxis': 'y'
})

# RIGHT PLOT: Comparison of numerical vs asymptotic
traces.append({
    'x': M_range.tolist(),
    'y': I_num_range,
    'mode': 'lines',
    'name': 'Numerical: ∫ e^{-Mx²} dx',
    'line': {'color': '#4caf50', 'width': 3},
    'xaxis': 'x2',
    'yaxis': 'y2'
})

traces.append({
    'x': M_range.tolist(),
    'y': I_asym_range,
    'mode': 'lines',
    'name': 'Asymptotic: √(π/M)',
    'line': {'color': '#ffa500', 'width': 2, 'dash': 'dot'},
    'xaxis': 'x2',
    'yaxis': 'y2'
})

# Mark current M value
traces.append({
    'x': [float(M_val)],
    'y': [I_numerical],
    'mode': 'markers',
    'name': f'Current: M = {M_val:.0f}',
    'marker': {'color': '#ff6b6b', 'size': 15, 'symbol': 'diamond'},
    'xaxis': 'x2',
    'yaxis': 'y2'
})

# Error plot (relative error)
traces.append({
    'x': M_range.tolist(),
    'y': I_error_range,
    'mode': 'lines',
    'name': 'Relative error (%)',
    'line': {'color': '#ff6b6b', 'width': 2, 'dash': 'dot'},
    'xaxis': 'x2',
    'yaxis': 'y3'
})

layout = {
    'title': f'Laplace\'s Method: I(M) = ∫ e^{{{M_val:.0f} h(x)}} dx | Numerical = {I_numerical:.6f}, Asymptotic = {I_asymptotic:.6f}',
    'height': 600,
    'showlegend': True,
    'xaxis': {
        'title': 'x',
        'domain': [0, 0.48],
        'range': [-1.5, 1.5]
    },
    'yaxis': {
        'title': 'Integrand',
        'domain': [0, 0.48],
        'range': [-0.1, 1.2]
    },
    'xaxis2': {
        'title': 'M',
        'domain': [0.52, 1],
        'range': [1, 50],
        'anchor': 'y2'
    },
    'yaxis2': {
        'title': 'I(M)',
        'domain': [0.52, 1],
        'type': 'log',
        'anchor': 'x2'
    },
    'yaxis3': {
        'title': 'Error (%)',
        'domain': [0, 0.48],
        'anchor': 'x2',
        'side': 'right'
    },
    'annotations': [
        {
            'text': f'Asymptotic accuracy: {abs(I_numerical - I_asymptotic)/I_numerical * 100:.3f}% error | Contribution region: {I_contrib/I_numerical*100:.1f}% of total',
            'x': 0.5,
            'y': 1.02,
            'xref': 'paper',
            'yref': 'paper',
            'showarrow': False,
            'font': {'size': 12, 'color': '#8b949e'}
        }
    ]
}

create_plot(traces, layout)</code></pre>
                    </div>
                </div>

                <div class="example">
                    <p><strong>Multiple Critical Points</strong></p>
                    <p>Analyze $I(M)=\int_{0}^{2\pi}e^{M\cos^{3}\theta}\,d\theta$.</p>
                    <p>Critical points at $\theta=0,\pi$ give quadratic contributions $\sim e^{M}\sqrt{2\pi/(3M)}$ and $e^{-M}\sqrt{2\pi/(3M)}$ (negligible). Degenerate points at $\theta=\pi/2,3\pi/2$ produce cubic scaling $\sim 0.838\,M^{-1/3}$. Thus</p>
                    $$I(M)\sim e^{M}\sqrt{\frac{2\pi}{3M}}+0.838\,M^{-1/3}+\cdots,$$
                    <p>illustrating how different critical-point types set distinct powers of $M$.</p>
                    <p>Degenerate critical points (where $h''(x_0) = 0$) produce different asymptotic scaling than non-degenerate ones. The geometry of the phase function near the critical point determines the power law in the asymptotic expansion.</p>
                </div>

            </section>

            <section>
                <h2>Method of Stationary Phase</h2>

                <div class="theorem">
                    <p><strong>Stationary Phase:</strong> For oscillatory integrals</p>
                    $$I(M)=\int_{-\infty}^{\infty}g(x)e^{i M h(x)}\,dx,$$
                    <p>rapid oscillations cancel except near stationary points where $h'(x_{0})=0$. Expanding $h$ quadratically yields</p>
                    $$I(M)\sim g(x_{0})e^{i M h(x_{0})}\sqrt{\frac{2\pi}{M\vert h''(x_{0}) \vert}}e^{i\frac{\pi}{4}\operatorname{sgn}(h''(x_{0}))},$$
                    <p>introducing the Maslov phase shift $\pi/4$ that later reappears in semiclassical quantization.</p>
                </div>

                <div class="example">
                    <p><strong>Stationary Phase Fresnel Integral</strong></p>
                    <p>Estimate $I(M)=\int_{0}^{\infty}e^{i M x^{2}}\,dx$.</p>
                    <p>The stationary point at $x=0$ (an endpoint) yields</p>
                    $$I(M)\sim \tfrac{1}{2}\sqrt{\frac{\pi}{M}}e^{i\pi/4},$$
                    <p>matching the exact Fresnel integral and exhibiting the $\pi/4$ phase.</p>
                    <p>The $\pi/4$ phase shift is fundamental to semiclassical mechanics, appearing whenever a classical trajectory passes through a turning point. This geometric phase encodes topological information about the path in phase space.</p>
                </div>

                <div class="example">
                    <p><strong>Wave Diffraction</strong></p>
                    <p>In Kirchhoff diffraction, $U(P)=\frac{1}{i\lambda}\iint_{S}\frac{e^{ik r}}{r}\cos\theta\,dS$ with $k\to\infty$.</p>
                    <p>Stationary phase at the specular point $(r=r_{0})$ gives $U(P)\sim \frac{A}{\sqrt{k}}e^{ik r_{0}}e^{i\pi/4}$, explaining the $k^{-1/2}$ decay and phase shift of Fresnel diffraction fringes.</p>
                    <p>Stationary phase provides the foundation for geometric optics: only rays from stationary points contribute in the high-frequency limit. The $k^{-1/2}$ decay reflects the two-dimensional nature of the diffraction surface.</p>
                </div>

                <div class="example">
                    <p><strong>Coherent vs. Incoherent Stationary Points</strong></p>
                    <p>Evaluate $I(M)=\int_{0}^{2\pi}e^{iM(\cos\theta +0.1\sin 2\theta)}\,d\theta$.</p>
                    <p>Two stationary points contribute amplitudes $I_{1,2}\sim (2\pi/M)^{1/2}e^{iM h(\theta_{1,2})\pm i\pi/4}$. The relative phase $\Delta\phi=M(h(\theta_{1})-h(\theta_{2}))$ determines interference: if $\Delta\phi\ll 2\pi$, the contributions add coherently; if $\Delta\phi\gg 2\pi$, intensities add incoherently.</p>
                    <p>When multiple stationary points contribute, interference effects depend on the phase relationships. Coherent addition occurs when phases are correlated; incoherent addition (intensity superposition) occurs when phases decorrelate through the large parameter $M$.</p>
                </div>

            </section>

            <section>
                <h2>WKB Approximation</h2>

                <div class="definition">
                    <p><strong>WKB Approximation:</strong> For $\epsilon^{2}y''+Q(x)y=0$ with $\epsilon\to 0$, seek $y=\exp(\epsilon^{-1}\sum_{n=0}^{\infty}\epsilon^{n}S_{n}(x))$. The leading terms satisfy</p>
                    $$(S_{0}')^{2}+Q(x)=0,\qquad 2S_{0}'S_{1}'+S_{0}''=0,$$
                    <p>giving</p>
                    $$y(x)\sim \frac{A}{Q(x)^{1/4}}\exp(\pm\frac{i}{\epsilon}\int^{x}\sqrt{Q(t)}\,dt).$$
                    <p>Oscillatory behavior occurs where $Q>0$, exponential where $Q<0$. Near turning points $Q(x_{0})=0$, WKB fails and must be matched to Airy-function solutions to obtain connection formulas.</p>
                </div>

                <div class="example">
                    <p><strong>WKB for the Harmonic Oscillator</strong></p>
                    <p>Solve $\epsilon^{2}y''+(1-x^{2})y=0$ via WKB.</p>
                    <p>The action integral $\int_{-1}^{1}\sqrt{1-x^{2}}\,dx=\pi/2$ leads to the Bohr–Sommerfeld rule $(n+\tfrac{1}{2})\pi\epsilon=\pi/2$, giving energy levels $E_{n}=(n+\tfrac{1}{2})\epsilon$. The WKB wavefunction in $\vert x \vert <1$ is</p>
                    $$y(x)\sim \frac{1}{(1-x^{2})^{1/4}}\cos(\frac{1}{\epsilon}\int^{x}\sqrt{1-t^{2}}\,dt - \frac{\pi}{4}).$$
                    <p>The WKB approximation captures the semiclassical limit: as $\epsilon\to 0$, quantum mechanics becomes classical mechanics, and the wavefunction becomes the classical action.</p>
                </div>

                <!-- CRISIS WIDGET: WKB Breakdown at Turning Point -->
                <div class="widget-module crisis-widget widget-continuous" id="wkb-turning-point-1-5">
                    <div class="module-header">
                        <h3>Interactive: WKB Breakdown at Turning Point</h3>
                        <div class="widget-controls">
                            <div class="widget-control">
                                <label>Small parameter $\epsilon$</label>
                                <input type="range" class="widget-slider" data-param="epsilon" min="0.05" max="0.5"
                                    step="0.01" value="0.1">
                                <span class="widget-value" data-param="epsilon">0.10</span>
                            </div>
                        </div>
                        <button class="run-button widget-run">Run</button>
                    </div>
                    <div class="plotly-container widget-output"></div>
                    <div class="code-block hidden">
                        <pre><code class="language-python">import numpy as np
from scipy.special import airy

# Parameters from widgets (injected automatically)
# epsilon_val will be injected here by widget engine

# WKB for: ε² y'' + Q(x) y = 0
# Example: Q(x) = x (turning point at x = 0)
# This is the Airy equation: y'' - (1/ε²) x y = 0
# After rescaling: Y'' - X Y = 0 where X = x/ε^{2/3}

# Compute exact Airy function solution
x_exact = np.linspace(-2, 2, 1000)
X_exact = x_exact / (epsilon_val**(2/3))
Ai_exact, _, _, _ = airy(X_exact)

# Normalize Airy function for better visualization
Ai_max = np.max(np.abs(Ai_exact[x_exact > 0.5]))
if Ai_max > 0:
    Ai_exact = Ai_exact / Ai_max

# WKB approximation (valid away from turning point)
# For x > 0 (oscillatory): y ~ A Q^{-1/4} cos((1/ε) ∫√Q dx - π/4)
# For x < 0 (exponential): y ~ B |Q|^{-1/4} exp(-(1/ε) ∫√|Q| dx)

# WKB in oscillatory region (x > 0)
# Start further from turning point for better accuracy
x_osc = np.linspace(max(0.3, 2*epsilon_val**(2/3)), 2, 500)
Q_osc = x_osc
# Action: S = ∫_0^x √Q dx = (2/3) x^{3/2}
S_osc = (2/3) * x_osc**(3/2)
# WKB: y ~ Q^{-1/4} cos(S/ε - π/4)
y_wkb_osc = (x_osc)**(-1/4) * np.cos(S_osc / epsilon_val - np.pi/4)

# Normalize WKB oscillatory to match Airy amplitude
if len(y_wkb_osc) > 0:
    wkb_max = np.max(np.abs(y_wkb_osc))
    if wkb_max > 0:
        y_wkb_osc = y_wkb_osc / wkb_max * np.max(np.abs(Ai_exact[x_exact > 0.5]))

# WKB in exponential region (x < 0)
x_exp = np.linspace(-2, -max(0.3, 2*epsilon_val**(2/3)), 500)
abs_Q_exp = np.abs(x_exp)
# Action: S = ∫_x^0 √|Q| dx = (2/3) |x|^{3/2}
S_exp = (2/3) * abs_Q_exp**(3/2)
# WKB: y ~ |Q|^{-1/4} exp(-S/ε)
y_wkb_exp = abs_Q_exp**(-1/4) * np.exp(-S_exp / epsilon_val)

# Normalize WKB exponential to match Airy
if len(y_wkb_exp) > 0:
    wkb_exp_max = np.max(np.abs(y_wkb_exp))
    if wkb_exp_max > 0:
        Ai_exp_max = np.max(np.abs(Ai_exact[x_exact < -0.5]))
        if Ai_exp_max > 0:
            y_wkb_exp = y_wkb_exp / wkb_exp_max * Ai_exp_max

# Compute Q(x) for visualization
Q_x = x_exact

traces = []

# LEFT PLOT: Exact Airy vs WKB
traces.append({
    'x': x_exact.tolist(),
    'y': Ai_exact.tolist(),
    'mode': 'lines',
    'name': 'Exact: Ai(x/ε^{2/3})',
    'line': {'color': '#4caf50', 'width': 3},
    'xaxis': 'x',
    'yaxis': 'y'
})

# WKB oscillatory (x > 0)
if len(x_osc) > 0:
    traces.append({
        'x': x_osc.tolist(),
        'y': y_wkb_osc.tolist(),
        'mode': 'lines',
        'name': 'WKB (oscillatory: x > 0)',
        'line': {'color': '#ff6b6b', 'width': 2, 'dash': 'dot'},
        'xaxis': 'x',
        'yaxis': 'y'
    })

# WKB exponential (x < 0)
if len(x_exp) > 0:
    traces.append({
        'x': x_exp.tolist(),
        'y': y_wkb_exp.tolist(),
        'mode': 'lines',
        'name': 'WKB (exponential: x < 0)',
        'line': {'color': '#ffa500', 'width': 2, 'dash': 'dot'},
        'xaxis': 'x',
        'yaxis': 'y'
    })

# Mark turning point
traces.append({
    'x': [0.0],
    'y': [0.0],
    'mode': 'markers',
    'name': 'Turning point: Q(0) = 0',
    'marker': {'color': '#f44336', 'size': 15, 'symbol': 'x', 'line': {'width': 2}},
    'xaxis': 'x',
    'yaxis': 'y'
})

# Mark WKB validity region
turning_region = 3 * epsilon_val**(2/3)
traces.append({
    'x': [-turning_region, -turning_region, turning_region, turning_region, -turning_region],
    'y': [-1.5, 1.5, 1.5, -1.5, -1.5],
    'mode': 'lines',
    'name': f'WKB breakdown region (|x| < 3ε^{{2/3}})',
    'line': {'color': '#f44336', 'width': 1, 'dash': 'dash'},
    'fill': 'toself',
    'fillcolor': 'rgba(244, 67, 54, 0.1)',
    'xaxis': 'x',
    'yaxis': 'y'
})

# RIGHT PLOT: Q(x) and error analysis
traces.append({
    'x': x_exact.tolist(),
    'y': Q_x.tolist(),
    'mode': 'lines',
    'name': 'Q(x) = x',
    'line': {'color': '#58a6ff', 'width': 3},
    'xaxis': 'x2',
    'yaxis': 'y2'
})

# Zero line
traces.append({
    'x': [-2, 2],
    'y': [0, 0],
    'mode': 'lines',
    'name': 'Q = 0 (turning point)',
    'line': {'color': '#8b949e', 'width': 1, 'dash': 'dash'},
    'xaxis': 'x2',
    'yaxis': 'y2'
})

# Error analysis: compare WKB and exact in oscillatory region
if len(x_osc) > 0:
    x_compare = np.linspace(0.5, 1.5, 300)
    X_compare = x_compare / (epsilon_val**(2/3))
    Ai_compare, _, _, _ = airy(X_compare)
    Ai_compare_norm = Ai_compare / np.max(np.abs(Ai_compare[x_compare > 0.5])) if np.max(np.abs(Ai_compare[x_compare > 0.5])) > 0 else Ai_compare
    
    # WKB at these points
    S_compare = (2/3) * x_compare**(3/2)
    y_wkb_compare = (x_compare)**(-1/4) * np.cos(S_compare / epsilon_val - np.pi/4)
    wkb_compare_max = np.max(np.abs(y_wkb_compare))
    if wkb_compare_max > 0:
        y_wkb_compare = y_wkb_compare / wkb_compare_max * np.max(np.abs(Ai_compare_norm))
    
    error = np.abs(y_wkb_compare - Ai_compare_norm)
    max_error = float(np.max(error)) if len(error) > 0 else 0.0
    
    traces.append({
        'x': x_compare.tolist(),
        'y': error.tolist(),
        'mode': 'lines',
        'name': f'|WKB - Exact| (max = {max_error:.4f})',
        'line': {'color': '#ff6b6b', 'width': 3},
        'xaxis': 'x2',
        'yaxis': 'y3'
    })

layout = {
    'title': f'WKB Breakdown: ε² y\'\' + x y = 0, ε = {epsilon_val:.3f} | WKB fails at turning point x = 0',
    'height': 600,
    'showlegend': True,
    'xaxis': {
        'title': 'x',
        'domain': [0, 0.48],
        'range': [-2, 2]
    },
    'yaxis': {
        'title': 'y(x)',
        'domain': [0.52, 1],
        'range': [-1.5, 1.5]
    },
    'xaxis2': {
        'title': 'x',
        'domain': [0.52, 1],
        'range': [-2, 2],
        'anchor': 'y2'
    },
    'yaxis2': {
        'title': 'Q(x)',
        'domain': [0.52, 1],
        'range': [-2, 2],
        'anchor': 'x2'
    },
    'yaxis3': {
        'title': '|Error|',
        'domain': [0, 0.48],
        'range': [0, 0.5],
        'anchor': 'x2',
        'side': 'right'
    },
    'annotations': [
        {
            'text': f'WKB breaks down in region |x| < 3ε^{{2/3}} ≈ {3*epsilon_val**(2/3):.3f}. Must match to Airy function.',
            'x': 0.5,
            'y': 1.02,
            'xref': 'paper',
            'yref': 'paper',
            'showarrow': False,
            'font': {'size': 12, 'color': '#8b949e'}
        }
    ]
}

create_plot(traces, layout)</code></pre>
                    </div>
                </div>

                <div class="example">
                    <p><strong>Quantum Tunneling via WKB</strong></p>
                    <p>Estimate tunneling in $V(x)=x^{4}-2x^{2}$.</p>
                    <p>In the forbidden region $\vert x \vert >1$, the WKB solution is $y\sim \vert Q \vert^{-1/4}\exp(-\epsilon^{-1}\int_{1}^{x}\sqrt{\vert Q \vert}\,dt)$. The splitting of nearly degenerate states is $\Delta E\sim e^{-2S/\epsilon}$ where $S=\int_{1}^{\infty}\sqrt{x^{4}-2x^{2}-1}\,dx\approx 1.44$.</p>
                    <p>WKB connects quantum mechanics to classical mechanics: the phase $\int \sqrt{Q} \, dx$ is the classical action, and the amplitude $Q^{-1/4}$ reflects the classical density of trajectories. Tunneling probabilities are exponentially suppressed by the action barrier.</p>
                </div>

                <div class="example">
                    <p><strong>Airy Turning-Point Matching</strong></p>
                    <p>For $Q(x)=x$, match WKB solutions across $x=0$.</p>
                    <p>The Airy equation $y''-xy=0$ has asymptotics</p>
                    $$\operatorname{Ai}(x)\sim \frac{1}{2\sqrt{\pi}x^{1/4}}e^{-\frac{2}{3}x^{3/2}},\quad x\to+\infty,$$
                    <p>and</p>
                    $$\operatorname{Ai}(x)\sim \frac{1}{\sqrt{\pi}\vert x \vert^{1/4}}\sin(\frac{2}{3}\vert x \vert^{3/2}+\frac{\pi}{4}),\quad x\to -\infty.$$
                    <p>Matching these yields the $\pi/4$ phase shift in the oscillatory region.</p>
                    <p>Turning points are where WKB breaks down: the classical trajectory reverses direction, creating a caustic. Matching to Airy functions provides connection formulas that link the exponential and oscillatory regions, introducing the $\pi/4$ phase shift characteristic of such transitions.</p>
                </div>

                <div class="cliffhanger">
                    WKB works beautifully away from turning points, but fails catastrophically where $Q(x_0) = 0$. The connection formulas require matching to Airy functions, introducing phase shifts that encode the topology of the classical trajectory. This local breakdown reveals global structure—the Stokes phenomenon in disguise.
                </div>

            </section>

            <section>
                <h2>Stokes Phenomenon</h2>

                <div class="definition">
                    <p><strong>Stokes Phenomenon:</strong> Asymptotic expansions like</p>
                    $$y(z)\sim e^{\lambda z}\sum_{n=0}^{\infty}\frac{a_{n}}{z^{n}}$$
                    <p>are sectorial: they hold only within wedges bounded by Stokes lines where $\Re(\lambda z)$ is constant. Crossing a Stokes line activates subdominant exponentials with discontinuous multipliers (often $\pm i$). Borel summation interprets the divergent series in each sector and glues them using these jumps, foreshadowing resurgence theory.</p>
                </div>

                <div class="example">
                    <p><strong>Stokes Lines for Airy Function</strong></p>
                    <p>Track $\operatorname{Ai}(z)$ across the complex plane.</p>
                    <p>Stokes lines occur at $\arg z=\pm\pi/3,\pi$. On $0<\arg z<2\pi/3$, only $e^{-\zeta}$ appears; crossing $\arg z=2\pi/3$ activates the subdominant $e^{+\zeta}$ with multiplier $i$. This discontinuity encodes the global analytic structure.</p>
                    <p>The Stokes phenomenon reveals that asymptotic expansions are not global: the form of the expansion jumps discontinuously across certain rays in the complex plane. These jumps encode topological information about the Riemann surface structure that cannot be captured by local series expansions.</p>
                </div>

                <div class="example">
                    <p><strong>Quantum Barrier Penetration and Stokes Jumps</strong></p>
                    <p>In alpha decay, analytic continuation around a turning point causes the transmission coefficient to jump discretely.</p>
                    <p>WKB solutions in the complex $r$-plane pick up Stokes multipliers when circling the barrier, quantizing decay rates and connecting asymptotic analysis to observable half-lives.</p>
                    <p>The Stokes phenomenon is not merely a mathematical curiosity—it has physical consequences. Quantum tunneling rates depend on these discontinuous jumps, connecting the abstract geometry of asymptotic analysis to measurable decay processes.</p>
                </div>

            </section>

            <!-- MASTERY CHALLENGES -->
            <section class="challenges">
                <h2>Mastery Challenges</h2>

                <details>
                    <summary>Challenge 1 [★★☆] Laplace's Method with Multiple Maxima</summary>
                    <p>For $I(M) = \int_{-1}^{1} e^{M(x^2 - x^4)} dx$, determine the asymptotic behavior as $M \to \infty$. The phase has two symmetric maxima. Show that both contribute equally, and compute the leading asymptotic.</p>
                    <details>
                        <summary>Solution</summary>
                        <p>The phase $h(x) = x^2 - x^4$ has maxima at $x = \pm 1/\sqrt{2}$ with $h(\pm 1/\sqrt{2}) = 1/4$ and $h''(\pm 1/\sqrt{2}) = -4$. Each maximum contributes $e^{M/4} \sqrt{2\pi/(4M)} = e^{M/4} \sqrt{\pi/(2M)}$. The total is $I(M) \sim 2 e^{M/4} \sqrt{\pi/(2M)} = e^{M/4} \sqrt{2\pi/M}$. This demonstrates that symmetric critical points contribute equally, and the asymptotic is simply doubled.</p>
                    </details>
                </details>

                <details>
                    <summary>Challenge 2 [★★★] Stationary Phase with Coherent Interference</summary>
                    <p>For $I(M) = \int_{0}^{2\pi} e^{iM(\cos\theta + \alpha \sin\theta)} d\theta$ with $\alpha \ll 1$, determine when the two stationary points interfere coherently versus incoherently. Show that the transition occurs when $M \alpha \sim 1$.</p>
                    <details>
                        <summary>Solution</summary>
                        <p>The stationary points satisfy $\sin\theta = \alpha \cos\theta$, giving $\theta_1 \approx 0$ and $\theta_2 \approx \pi$ for small $\alpha$. The phase difference is $\Delta\phi = M(h(\theta_1) - h(\theta_2)) \approx 2M$. When $2M \ll 2\pi$ (i.e., $M \ll \pi$), the contributions add coherently with interference. When $2M \gg 2\pi$ (i.e., $M \gg \pi$), the phases decorrelate and intensities add. The transition occurs when $M \sim \pi$, independent of $\alpha$ for small $\alpha$. More precisely, the coherence length is determined by the phase correlation, which depends on the curvature of $h$ at the stationary points.</p>
                    </details>
                </details>

                <details>
                    <summary>Challenge 3 [★★★] WKB Connection Formulas</summary>
                    <p>Derive the connection formulas for WKB solutions across a simple turning point. Show that an exponential solution on one side connects to a linear combination of oscillatory solutions on the other, with the $\pi/4$ phase shift. Use the Airy function matching method.</p>
                    <details>
                        <summary>Solution</summary>
                        <p>Near a turning point at $x = 0$ with $Q(x) \approx Q'(0) x$, the equation becomes $y'' - (Q'(0)/\epsilon^2) x y = 0$. Rescaling $X = (Q'(0)/\epsilon^2)^{1/3} x$ gives the Airy equation. The Airy function $\operatorname{Ai}(X)$ decays exponentially for $X > 0$ and oscillates for $X < 0$ with asymptotics $\operatorname{Ai}(X) \sim (1/(2\sqrt{\pi})) X^{-1/4} e^{-(2/3)X^{3/2}}$ for $X \to +\infty$ and $\operatorname{Ai}(X) \sim (1/\sqrt{\pi}) |X|^{-1/4} \sin((2/3)|X|^{3/2} + \pi/4)$ for $X \to -\infty$. Matching these to WKB forms yields the connection: an exponential solution $|Q|^{-1/4} \exp(-\epsilon^{-1} \int \sqrt{|Q|} dx)$ for $x < 0$ connects to $Q^{-1/4} \cos(\epsilon^{-1} \int \sqrt{Q} dx - \pi/4)$ for $x > 0$. The $\pi/4$ phase shift is universal for simple turning points.</p>
                    </details>
                </details>

            </section>

            <!-- FINAL CLIFFHANGER -->
            <div class="cliffhanger final">
                <p>We have mastered Laplace's method, stationary phase, and WKB approximation. These tools extract asymptotic behavior from critical points, revealing how local geometry determines global limits. But this extraction is not global: the asymptotic expansion jumps discontinuously across Stokes lines, encoding topological information that cannot be captured by any local series. The Stokes phenomenon reveals that asymptotic analysis is not merely approximation—it is a topological tool that connects local behavior to global structure through discontinuous jumps. In the next section, we systematize these jumps through perturbation theory, only to discover that the perturbation series itself diverges, forcing us to confront the need for renormalization and non-perturbative methods.</p>
            </div>

            <!-- REFERENCES -->
            <section class="references">
                <h2>Key References</h2>
                <ul>
                    <li>Bender, C. M. & Orszag, S. A. (1999). <em>Advanced Mathematical Methods for Scientists and Engineers</em>.</li>
                    <li>Olver, F. W. J. (1974). <em>Asymptotics and Special Functions</em>.</li>
                    <li>Miller, P. D. (2006). <em>Applied Asymptotic Analysis</em>.</li>
                    <li>Berry, M. V. & Howls, C. J. (1991). <em>Hyperasymptotics</em>.</li>
                </ul>
            </section>

            <!-- NAVIGATION -->
            <nav class="navigation">
                <hr>
                <ul>
                    <li>Previous → <a href="/diffequations/chapter-01/01-4-linear-pde/">Section 1.4: Classical Linear Partial Differential Equations</a></li>
                    <li>Next → <a href="/diffequations/chapter-01/01-6-perturbation-theory/">Section 1.6: Classical Perturbation Theory</a></li>
                    <li><a href="/diffequations/chapter-01/">Chapter 1 Contents</a></li>
                    <li><a href="/diffequations/">Full Table of Contents</a></li>
                </ul>
            </nav>

        </article>
    </main>

    <!-- Python/Plotly Widget System - Load after content -->
    <script>
        // Lazy load Plotly.js after page is fully loaded
        window.addEventListener('load', function () {
            var plotlyScript = document.createElement('script');
            plotlyScript.src = 'https://cdn.plot.ly/plotly-2.27.0.min.js';
            plotlyScript.charset = 'utf-8';
            plotlyScript.async = true;
            plotlyScript.onload = function () {
                console.log('Plotly.js loaded successfully');
            };
            plotlyScript.onerror = function () {
                console.error('Failed to load Plotly.js');
            };
            document.body.appendChild(plotlyScript);
        });
    </script>

    <!-- Widget Engine Scripts - Load with defer to not block rendering -->
    <script defer src="/diffequations/js/textbook-engine.js"></script>
    <script defer src="/diffequations/js/widget-engine.js"></script>
</body>

</html>
