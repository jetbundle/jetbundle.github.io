<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Section 1.4: Classical Linear Partial Differential Equations</title>
    <meta name="description"
        content="Separation of variables succeeds when symmetry allows diagonalization — until nonlinearity creates shocks that break the classical framework.">

    <!-- KaTeX – canonical loading -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {delimiters: [{left:'$$',right:'$$',display:true},{left:'$',right:'$',display:false}], throwOnError:false});">
        </script>

    <link rel="stylesheet" href="/diffequations/styles.css">
    <script src="/diffequations/navigation-data.js"></script>
    <script src="/diffequations/navigation.js"></script>
    <!-- Manifold background only on main index -->
</head>

<body>
    <main>
        <!-- 1. HOOK -->
        <header class="hook">
            <h1>Section 1.4: Classical Linear Partial Differential Equations</h1>
            <p class="hook-text">
                The geometry of the domain dictates the mathematics: separation of variables succeeds when symmetry allows simultaneous diagonalization of commuting operators.
            </p>
            <p class="hook-subtitle">
                But nonlinearity creates shocks where characteristics intersect, and the classical solution breaks down.
            </p>
        </header>

        <!-- 2. DESCRIPTION -->
        <p class="description">
            Classification, separation of variables, eigenfunction expansions, characteristics, and the shock formation that forces us toward weak solutions.
        </p>

        <article>

            <!-- 3. NARRATIVE INTRODUCTION (3 paragraphs) -->
            <section class="narrative-intro">
                <p>We extend ODE methods to fields. When the domain has symmetry—a sphere, a cylinder, a box—separation of variables reduces partial differential equations to families of ordinary differential equations. The Laplacian diagonalizes in spherical harmonics, the heat operator separates into spatial eigenmodes, the wave operator propagates along characteristics. For a moment, everything works. The solution is a superposition of eigenfunctions, each evolving independently according to its eigenvalue.</p>
                <p>But this success is fragile. The method requires exact symmetry. The boundary conditions must be homogeneous. The initial data must be smooth. When these conditions fail—when the boundary is irregular, when the data is discontinuous, when nonlinearity enters—separation of variables breaks down. More fundamentally, even when it works, the question remains: in what sense does an infinite series of smooth functions converge to a discontinuous boundary condition?</p>
                <p>This convergence crisis is not merely technical. It reveals that the classical calculus of functions is too narrow. We need a framework that can handle distributions, weak derivatives, and measure-valued solutions. The shock formation in nonlinear equations—where characteristics intersect and the solution becomes multivalued—forces us to abandon the classical notion of a solution entirely. What survives is the recognition that PDEs encode geometric and topological information that cannot be captured by pointwise values alone.</p>
            </section>

            <!-- CORE CONTENT WITH SEMANTIC BLOCKS & INTERMEDIATE CLIFFHANGERS -->

            <section>
                <h2>Classification and Canonical Forms</h2>

                <div class="definition">
                    <p><strong>PDE Classification:</strong> Consider the second-order linear PDE</p>
                    $$A u_{xx}+2B u_{xy}+C u_{yy}+D u_{x}+E u_{y}+F u=G,$$
                    <p>with discriminant $\Delta=B^{2}-AC$. The sign of $\Delta$ distinguishes physical regimes:</p>
                    <ul>
                        <li><strong>Elliptic ($\Delta<0$)</strong> – e.g., Laplace's equation $\Delta u=0$, modeling equilibrium and instantaneous smoothing.</li>
                        <li><strong>Parabolic ($\Delta=0$)</strong> – e.g., Heat equation $u_{t}-\Delta u=0$, capturing diffusive dynamics with a causal time arrow.</li>
                        <li><strong>Hyperbolic ($\Delta>0$)</strong> – e.g., Wave equation $u_{tt}-c^{2}\Delta u=0$, describing finite-speed propagation along characteristics.</li>
                    </ul>
                </div>

                <p>Characteristic curves satisfy $A(dy)^{2}-2B dx\,dy+C(dx)^{2}=0$. Transforming to characteristic coordinates $(\xi,\eta)$ diagonalizes the principal part, yielding canonical forms such as $u_{\xi\eta}=0$ in the hyperbolic case.</p>

                <div class="example">
                    <p><strong>Discriminant Classification</strong></p>
                    <p>Classify $3u_{xx}+4u_{xy}+5u_{yy}=0$.</p>
                    <p>The discriminant $\Delta=4^{2}-3\cdot 5=1>0$, so the PDE is hyperbolic. Characteristics solve $3(dy)^{2}-4 dx\,dy+5(dx)^{2}=0$, yielding complex slopes $(2\pm i\sqrt{11})/3$. Real canonical coordinates $\xi=x$, $\eta=y-\tfrac{2}{3}x$ reduce the equation to $u_{\xi\xi}-u_{\eta\eta}=0$, revealing wave-like behavior.</p>
                </div>

                <div class="example">
                    <p><strong>Variable-Coefficient Classification</strong></p>
                    <p>Determine the type of $x u_{xx}+2u_{xy}+y u_{yy}=0$.</p>
                    <p>Here $\Delta(x,y)=4-xy$. The equation is elliptic where $xy<4$, parabolic on $xy=4$, and hyperbolic when $xy>4$. The curve $xy=4$ resembles the Tricomi equation, modeling mixed-type phenomena such as transonic flow.</p>
                </div>

                <div class="cliffhanger">
                    Classification determines the fundamental character of the PDE: elliptic equations smooth data instantaneously, parabolic equations diffuse over time, and hyperbolic equations propagate along characteristics. However, variable coefficients can create mixed-type regions, revealing the limitations of this classification.
                </div>

                <div class="example">
                    <p><strong>Canonical Hyperbolic Reduction</strong></p>
                    <p>Reduce $u_{xx}-3u_{xy}+2u_{yy}=0$.</p>
                    <p>The discriminant is $\Delta=(-3)^{2}-4\cdot 1\cdot 2=1>0$. Characteristics satisfy $dy/dx=r$ with $r_{1,2}=\{2,1\}$. Coordinates $\xi=y-2x$ and $\eta=y-x$ transform the PDE to $u_{\xi\eta}=0$, leading to $u(x,y)=f(y-2x)+g(y-x)$.</p>
                    <p>The general solution is a superposition of arbitrary functions of the characteristic coordinates. This d'Alembert representation is fundamental to understanding wave propagation.</p>
                </div>

            </section>

            <section>
                <h2>Separation of Variables and Spectral Theory</h2>

                <div class="theorem">
                    <p><strong>Separation of Variables:</strong> Symmetric domains admit separated solutions $u(x,t)=X(x)T(t)$. Substitution reduces the PDE to a spatial eigenvalue problem</p>
                    $$\mathcal{L}X=\lambda w(x)X,$$
                    <p>subject to homogeneous boundary conditions. The Rayleigh quotient</p>
                    $$\lambda_{1}=\min_{u\neq 0}\frac{\int_{\Omega}\vert \nabla u \vert^{2}dx}{\int_{\Omega}u^{2}dx}$$
                    <p>characterizes the principal eigenvalue. Maximum principles imply interior extrema occur on $\partial\Omega$, providing uniqueness and a priori bounds without explicit solutions.</p>
                </div>

                <div class="example">
                    <p><strong>Heat Equation with Dirichlet Data</strong></p>
                    <p>Solve $u_{t}=u_{xx}$ on $0<x<\pi$ with $u(0,t)=u(\pi,t)=0$, $u(x,0)=\sin(3x)$.</p>
                    <p>Separation $u=XT$ gives $X''+\lambda X=0$ with eigenvalues $\lambda_{n}=n^{2}$ and eigenfunctions $\sin(nx)$. The temporal factors are $T_{n}=e^{-n^{2}t}$. Expanding the initial data reveals only $n=3$ is present, so $u(x,t)=e^{-9t}\sin(3x)$.</p>
                    <p>This demonstrates that separation of variables reduces the PDE to an eigenvalue problem, with each eigenmode evolving independently. Higher modes decay faster, reflecting the smoothing property of the heat equation.</p>
                </div>

                <!-- VICTORY WIDGET: Heat Equation Solution -->
                <div class="widget-module victory-widget widget-continuous" id="heat-equation-1-4">
                    <div class="module-header">
                        <h3>Interactive: Heat Equation Evolution</h3>
                        <div class="widget-controls">
                            <div class="widget-control">
                                <label>Time $t$</label>
                                <input type="range" class="widget-slider" data-param="t" min="0" max="0.5" step="0.01"
                                    value="0">
                                <span class="widget-value" data-param="t">0.0</span>
                            </div>
                            <div class="widget-control">
                                <label>Number of modes $N$</label>
                                <input type="range" class="widget-slider" data-param="N" min="1" max="20" step="1"
                                    value="5">
                                <span class="widget-value" data-param="N">5</span>
                            </div>
                        </div>
                        <button class="run-button widget-run">Run</button>
                    </div>
                    <div class="plotly-container widget-output"></div>
                    <div class="code-block hidden">
                        <pre><code class="language-python">import numpy as np

# Parameters from widgets (injected automatically)
# t_val will be injected here by widget engine
# N_val will be injected here by widget engine

# Heat equation: u_t = u_xx on [0, π] with u(0,t) = u(π,t) = 0
# Initial condition: u(x,0) = sin(3x) (single mode)
# Solution: u(x,t) = e^{-9t} sin(3x) for exact initial condition
# For general initial data: u(x,t) = Σ_n a_n e^{-n²t} sin(nx)

x = np.linspace(0, np.pi, 500)

# Exact solution for u(x,0) = sin(3x)
u_exact = np.exp(-9 * t_val) * np.sin(3 * x)

# Fourier series expansion: u(x,0) = Σ_n a_n sin(nx)
# For general initial data, compute first N modes
u_series = np.zeros_like(x)
for n in range(1, N_val + 1):
    # For initial condition sin(3x), only n=3 contributes
    # But we'll show the full series expansion for demonstration
    if n == 3:
        a_n = 1.0  # Coefficient for sin(3x)
    else:
        a_n = 0.0  # Other modes are zero for this initial condition
    u_series += a_n * np.exp(-n**2 * t_val) * np.sin(n * x)

# For a more interesting demonstration, use a step function initial condition
# u(x,0) = 1 for x < π/2, 0 for x > π/2
u_step_initial = np.zeros_like(x)
u_step_initial[x < np.pi/2] = 1.0

# Compute Fourier coefficients for step function
u_step_series = np.zeros_like(x)
for n in range(1, N_val + 1):
    # Fourier sine coefficients: a_n = (2/π) ∫_0^π u(x,0) sin(nx) dx
    # For step function: a_n = (2/π) ∫_0^{π/2} sin(nx) dx = (2/(nπ)) (1 - cos(nπ/2))
    if n % 2 == 1:
        a_n = 2 / (n * np.pi) * (1 - np.cos(n * np.pi / 2))
    else:
        a_n = 2 / (n * np.pi) * (1 - np.cos(n * np.pi / 2))
    u_step_series += a_n * np.exp(-n**2 * t_val) * np.sin(n * x)

traces = []

# LEFT PLOT: Single mode solution (exact)
traces.append({
    'x': x.tolist(),
    'y': u_exact.tolist(),
    'mode': 'lines',
    'name': f'Exact: e^{{-9t}} sin(3x) at t = {t_val:.2f}',
    'line': {'color': '#4caf50', 'width': 3},
    'xaxis': 'x',
    'yaxis': 'y'
})

# RIGHT PLOT: Step function with N modes
traces.append({
    'x': x.tolist(),
    'y': u_step_initial.tolist(),
    'mode': 'lines',
    'name': 'Initial: step function',
    'line': {'color': '#8b949e', 'width': 2, 'dash': 'dash'},
    'xaxis': 'x2',
    'yaxis': 'y2'
})

traces.append({
    'x': x.tolist(),
    'y': u_step_series.tolist(),
    'mode': 'lines',
    'name': f'Series (N = {N_val} modes) at t = {t_val:.2f}',
    'line': {'color': '#ff6b6b', 'width': 2},
    'xaxis': 'x2',
    'yaxis': 'y2'
})

layout = {
    'title': f'Heat Equation: u_t = u_{{xx}}, u(0,t) = u(π,t) = 0 | t = {t_val:.2f}, N = {N_val} modes',
    'height': 550,
    'showlegend': True,
    'xaxis': {
        'title': 'x',
        'domain': [0, 0.48],
        'range': [0, np.pi]
    },
    'yaxis': {
        'title': 'u(x,t)',
        'domain': [0, 1],
        'range': [-0.2, 1.2]
    },
    'xaxis2': {
        'title': 'x',
        'domain': [0.52, 1],
        'range': [0, np.pi],
        'anchor': 'y2'
    },
    'yaxis2': {
        'title': 'u(x,t)',
        'domain': [0, 1],
        'anchor': 'x2'
    },
    'annotations': [
        {
            'text': f'Higher modes decay faster: e^{{-n²t}} → 0 as t → ∞',
            'x': 0.5,
            'y': 1.02,
            'xref': 'paper',
            'yref': 'paper',
            'showarrow': False,
            'font': {'size': 12, 'color': '#8b949e'}
        }
    ]
}

create_plot(traces, layout)</code></pre>
                    </div>
                </div>

                <div class="example">
                    <p><strong>Rayleigh Quotient Verification</strong></p>
                    <p>Verify $\lambda_{1}=1$ for $-u''=\lambda u$ with $u(0)=u(\pi)=0$.</p>
                    <p>The Rayleigh quotient</p>
                    $$R[u]=\frac{\int_{0}^{\pi}(u')^{2}dx}{\int_{0}^{\pi}u^{2}dx}$$
                    <p>is minimized by $u=\sin x$, giving $R[\sin x]=1$. Alternative test functions yield $R[u]>1$, confirming the principal eigenvalue.</p>
                    <p>Separation of variables reduces the PDE to an eigenvalue problem, with each eigenmode evolving independently. The Rayleigh quotient provides a variational characterization of eigenvalues without solving the differential equation explicitly.</p>
                </div>

                <div class="example">
                    <p><strong>Wave Equation with Mixed Boundaries</strong></p>
                    <p>Solve $u_{tt}=u_{xx}$ on $0<x<\pi$, with $u(0,t)=0$ and $u_{x}(\pi,t)=0$.</p>
                    <p>Separation imposes $X(0)=0$ and $X'(\pi)=0$, leading to eigenfunctions $\sin((2n-1)x/2)$ with $\lambda_{n}=\tfrac{(2n-1)^{2}}{4}$. The solution is</p>
                    $$u(x,t)=\sum_{n=1}^{\infty}(a_{n}\cos\frac{(2n-1)t}{2}+b_{n}\sin\frac{(2n-1)t}{2})\sin\frac{(2n-1)x}{2},$$
                    <p>with coefficients fixed by initial data.</p>
                    <p>Mixed boundary conditions produce different eigenfunctions and eigenvalues. The solution is a superposition of standing waves, each oscillating at its characteristic frequency.</p>
                </div>

            </section>

            <section>
                <h2>Fourier Series and Eigenfunction Expansions</h2>

                <div class="theorem">
                    <p><strong>Eigenfunction Expansions:</strong> Eigenfunctions $\{\phi_{n}\}$ yield superpositions $u(x,t)=\sum_{n}a_{n}(t)\phi_{n}(x)$. Convergence issues arise when reconstructing initial data $f(x)$ from the series $\sum c_{n}\phi_{n}(x)$:</p>
                    <ul>
                        <li><strong>Dirichlet's theorem</strong> gives pointwise convergence for piecewise $C^{1}$ data to $\tfrac{1}{2}(f(x^{+})+f(x^{-}))$.</li>
                        <li><strong>Divergence examples</strong> show continuous functions whose Fourier series diverge at points.</li>
                        <li><strong>Gibbs phenomenon</strong> exhibits persistent overshoot near jumps.</li>
                    </ul>
                    <p>Cesàro summation via the Fejér kernel $F_{N}$ restores uniform convergence for continuous data, foreshadowing mollification and Sobolev-space regularization.</p>
                </div>

                <div class="example">
                    <p><strong>Fourier Series and Gibbs Phenomenon</strong></p>
                    <p>Expand $f(x)=\operatorname{sgn}(x)$ on $(-\pi,\pi)$.</p>
                    <p>Only sine terms appear: $f(x)\sim \frac{4}{\pi}\sum_{k=1,3,5,\dots}\frac{\sin(kx)}{k}$. Partial sums overshoot near $x=0$ by approximately $0.08949$ (17.9% of the jump) regardless of how many terms are added—the Gibbs phenomenon—illustrating the limitations of pointwise convergence.</p>
                </div>

                <div class="example">
                    <p><strong>Cesàro Summability via Fejér Kernel</strong></p>
                    <p>Show Fejér means converge uniformly for continuous $f$.</p>
                    <p>Define $\sigma_{N}(f)=\frac{1}{N+1}\sum_{k=0}^{N}S_{k}(f)=f*F_{N}$, where $F_{N}$ is the Fejér kernel. Since $F_{N}\ge 0$, $\int F_{N}=2\pi$, and $F_{N}$ concentrates at $0$, convolution with $F_{N}$ approximates $f$ uniformly by continuity, demonstrating a summability method that bypasses Gibbs oscillations.</p>
                    <p>Pointwise convergence is fragile: even continuous functions can have divergent Fourier series. Cesàro summation provides a more robust convergence method, but it requires modifying the partial sums, revealing that the standard Fourier expansion is fundamentally a limit in $L^2$, not pointwise.</p>
                </div>

            </section>

            <section>
                <h2>Method of Characteristics</h2>

                <div class="definition">
                    <p><strong>Characteristics:</strong> First-order hyperbolic equations propagate data along characteristic curves. For</p>
                    $$u_{t}+a(x,t,u)u_{x}=0,$$
                    <p>characteristics satisfy $\frac{dx}{dt}=a$ and $\frac{du}{dt}=0$, yielding $u(x,t)=u_{0}(x-at)$ for constant $a$. Nonlinear velocities $a(u)$ cause characteristic intersection, signaling shock formation and motivating weak/entropy solutions in Chapter 3.</p>
                </div>

                <div class="example">
                    <p><strong>Transport Equation</strong></p>
                    <p>Solve $u_{t}+3u_{x}=0$ with $u(x,0)=\sin x$.</p>
                    <p>Characteristics satisfy $x=x_{0}+3t$. Along each, $u$ is constant, so $u(x,t)=\sin(x-3t)$, confirming the transport of initial data without distortion.</p>
                </div>

                <div class="example">
                    <p><strong>Variable-Coefficient Transport</strong></p>
                    <p>Solve $u_{t}+(x+t)u_{x}=0$ with $u(x,0)=e^{x}$.</p>
                    <p>Characteristics solve $\frac{dx}{dt}=x+t$, giving $x+t=Ce^{t}$ and $C=x_{0}$. Along the curve, $u$ remains $e^{x_{0}}$, yielding $u(x,t)=\exp(x e^{-t}+t e^{-t})$ after eliminating $x_{0}$.</p>
                    <p>Characteristics represent paths along which information propagates. For constant coefficients, the solution is simply the initial data translated. Variable coefficients create more complex trajectories, but the solution remains constant along each characteristic curve.</p>
                </div>

                <div class="example">
                    <p><strong>Burgers' Equation Shock</strong></p>
                    <p>For $u_{t}+u u_{x}=0$ with $u(x,0)=1-x$, find shock time.</p>
                    <p>Characteristics satisfy $dx/dt=u=1-x_{0}$, so $x=x_{0}+(1-x_{0})t$. Inverting gives $x_{0}=(x-t)/(1+t)$ and $u=(1+x)/(1+t)$. Since $\partial x/\partial x_{0}=1-t$ vanishes at $t=1$, characteristics intersect and a shock forms for $t>1$.</p>
                    <p>Nonlinearity causes characteristics to intersect, creating shocks where the classical solution breaks down. This fundamental limitation motivates the weak solution framework of Chapter 3.</p>
                </div>

                <!-- CRISIS WIDGET: Shock Formation -->
                <div class="widget-module crisis-widget widget-continuous" id="shock-formation-1-4">
                    <div class="module-header">
                        <h3>Interactive: Watch Shocks Form — Burgers' Equation</h3>
                        <div class="widget-controls">
                            <div class="widget-control">
                                <label>Time $t$</label>
                                <input type="range" class="widget-slider" data-param="t" min="0" max="1.5" step="0.05"
                                    value="0.5">
                                <span class="widget-value" data-param="t">0.5</span>
                            </div>
                        </div>
                        <button class="run-button widget-run">Run</button>
                    </div>
                    <div class="plotly-container widget-output"></div>
                    <div class="code-block hidden">
                        <pre><code class="language-python">import numpy as np

# Parameters from widgets (injected automatically)
# t_val will be injected here by widget engine

# Burgers' equation: u_t + u u_x = 0
# Initial condition: u(x,0) = 1 - x for x in [0, 1]
# Characteristics: x = x_0 + (1 - x_0) t
# Shock forms when characteristics intersect: t = 1

x = np.linspace(-0.5, 1.5, 1000)

# For t < 1: classical solution exists
# u(x,t) = (1 + x) / (1 + t) for x in appropriate range
# But we need to handle the multivalued region after shock

if t_val < 1.0:
    # Before shock: classical solution
    # From characteristics: x = x_0 + (1 - x_0) t
    # Inverting: x_0 = (x - t) / (1 - t)
    # u(x,t) = 1 - x_0 = 1 - (x - t)/(1 - t) = (1 + x)/(1 + t)
    
    # Valid range: x_0 in [0, 1] means x in [t, 1 + t]
    x_valid = np.linspace(max(0, t_val), min(1.5, 1 + t_val), 500)
    u_classical = (1 + x_valid) / (1 + t_val)
    
    # Outside valid range, solution is not defined by this method
    u = np.full_like(x, np.nan)
    mask = (x >= t_val) & (x <= 1 + t_val)
    u[mask] = np.interp(x[mask], x_valid, u_classical)
    
    shock_time = 1.0
    shock_formed = False
else:
    # After shock: multivalued solution (classical breaks down)
    # Shock location: x_s = t (from Rankine-Hugoniot)
    # Left state: u_L = 1 (from x_0 = 0)
    # Right state: u_R = 0 (from x_0 = 1)
    
    shock_x = t_val
    u = np.full_like(x, np.nan)
    
    # Left of shock: u = 1 (from characteristic x_0 = 0)
    mask_left = x < shock_x
    u[mask_left] = 1.0
    
    # Right of shock: u = 0 (from characteristic x_0 = 1, but this is approximate)
    # Actually, for x > 1 + t, no characteristics reach here
    mask_right = x > shock_x
    u[mask_right] = 0.0
    
    shock_time = 1.0
    shock_formed = True

# Plot characteristics for visualization
x0_samples = np.linspace(0, 1, 20)
characteristics_x = []
characteristics_t = []
for x0 in x0_samples:
    t_char = np.linspace(0, min(1.5, t_val + 0.1), 100)
    x_char = x0 + (1 - x0) * t_char
    characteristics_x.extend(x_char.tolist())
    characteristics_t.extend(t_char.tolist())

traces = []

# Main solution
traces.append({
    'x': x.tolist(),
    'y': u.tolist(),
    'mode': 'lines',
    'name': f'u(x,t) at t = {t_val:.2f}',
    'line': {'color': '#ff6b6b', 'width': 3},
    'xaxis': 'x',
    'yaxis': 'y'
})

# Mark shock location if formed
if shock_formed:
    traces.append({
        'x': [shock_x, shock_x],
        'y': [0, 1.2],
        'mode': 'lines',
        'name': f'Shock at x = {shock_x:.2f}',
        'line': {'color': '#f44336', 'width': 2, 'dash': 'dash'},
        'xaxis': 'x',
        'yaxis': 'y'
    })

# Initial condition
x_init = np.linspace(0, 1, 100)
u_init = 1 - x_init
traces.append({
    'x': x_init.tolist(),
    'y': u_init.tolist(),
    'mode': 'lines',
    'name': 'Initial: u(x,0) = 1 - x',
    'line': {'color': '#8b949e', 'width': 2, 'dash': 'dot'},
    'xaxis': 'x',
    'yaxis': 'y'
})

layout = {
    'title': f'Burgers\' Equation: u_t + u u_x = 0 | t = {t_val:.2f} {"(SHOCK FORMED)" if shock_formed else ""}',
    'height': 550,
    'showlegend': True,
    'xaxis': {
        'title': 'x',
        'range': [-0.5, 1.5]
    },
    'yaxis': {
        'title': 'u(x,t)',
        'range': [-0.2, 1.2]
    },
    'annotations': [
        {
            'text': f'Shock time: t = {shock_time:.1f}. Classical solution breaks down for t > {shock_time:.1f}',
            'x': 0.5,
            'y': 1.02,
            'xref': 'paper',
            'yref': 'paper',
            'showarrow': False,
            'font': {'size': 12, 'color': '#8b949e'}
        }
    ]
}

create_plot(traces, layout)</code></pre>
                    </div>
                </div>

                <div class="cliffhanger">
                    Nonlinearity causes characteristics to intersect, creating shocks where the classical solution breaks down. The method of characteristics, which works perfectly for linear equations, fails catastrophically when the velocity depends on the solution itself. We need a new framework—weak solutions, entropy conditions, measure-valued solutions—to handle what classical analysis cannot.
                </div>

            </section>

            <section>
                <h2>Spherical Harmonics and Special Coordinates</h2>

                <div class="theorem">
                    <p><strong>Spherical Harmonics:</strong> Solving $\Delta u=0$ in curvilinear coordinates separates the Laplacian into orthogonal pieces. In spherical coordinates, the angular part produces spherical harmonics $Y_{\ell}^{m}(\theta,\phi)$ and radial Euler equations with solutions $r^{\ell}$ and $r^{-(\ell+1)}$. The addition theorem</p>
                    $$P_{\ell}(\cos\gamma)=\frac{4\pi}{2\ell+1}\sum_{m=-\ell}^{\ell}Y_{\ell}^{m}(\Omega_{1})\overline{Y_{\ell}^{m}(\Omega_{2})}$$
                    <p>enables expansions of rotationally invariant potentials.</p>
                </div>

                <div class="example">
                    <p><strong>Spherical Harmonics for Laplace's Equation</strong></p>
                    <p>Solve $\Delta u=0$ in the unit ball with $u(1,\theta,\phi)=\cos\theta$.</p>
                    <p>Separation yields radial factors $r^{\ell}$ and angular spherical harmonics $Y_{\ell}^{m}$. The boundary data correspond to $\ell=1$, $m=0$, so $u(r,\theta,\phi)=r Y_{1}^{0}(\theta,\phi)=r\cos\theta$.</p>
                    <p>The boundary condition forces $l=1$, so $u(r,\theta)=A r \cos\theta$. Matching the boundary gives $A=1$.</p>
                </div>

                <div class="example">
                    <p><strong>Addition Theorem Check</strong></p>
                    <p>Verify the addition theorem for $\ell=1$.</p>
                    <p>Using explicit forms of $Y_{1}^{m}$, one obtains</p>
                    $$\cos\gamma=\frac{4\pi}{3}\sum_{m=-1}^{1}Y_{1}^{m}(\Omega_{1})\overline{Y_{1}^{m}(\Omega_{2})},$$
                    <p>where $\gamma$ is the angle between $\Omega_{1}$ and $\Omega_{2}$. This identity underpins expansions of rotationally symmetric kernels.</p>
                </div>

                <div class="example">
                    <p><strong>Exterior Harmonic Potential via Spherical Harmonics</strong></p>
                    <p>Solve $\Delta u=0$ for $r>1$ with $u(1,\theta,\phi)=\cos^{3}\theta$.</p>
                    <p>Using $\cos^{3}\theta=\tfrac{3}{4}\cos\theta+\tfrac{1}{4}\cos 3\theta$ and expanding in $Y_{\ell}^{0}$, the exterior solution becomes</p>
                    $$u(r,\theta,\phi)=\frac{1}{3}r^{-2}Y_{1}^{0}(\theta,\phi)+\frac{1}{15}r^{-4}Y_{3}^{0}(\theta,\phi),$$
                    <p>illustrating how spherical harmonics encode boundary data.</p>
                    <p>Spherical harmonics provide a complete basis for functions on the sphere, just as Fourier series do for functions on the circle. The addition theorem reveals the deep connection between spherical harmonics and Legendre polynomials, enabling efficient computation of rotationally symmetric potentials.</p>
                </div>

            </section>

            <!-- MASTERY CHALLENGES -->
            <section class="challenges">
                <h2>Mastery Challenges</h2>

                <details>
                    <summary>Challenge 1 [★★☆] Mixed-Type PDE Classification</summary>
                    <p>For the Tricomi equation $y u_{xx} + u_{yy} = 0$, determine the regions where it is elliptic, parabolic, and hyperbolic. Show that the transition curve $y=0$ is a characteristic, and discuss the physical interpretation of mixed-type equations.</p>
                    <details>
                        <summary>Solution</summary>
                        <p>The discriminant is $\Delta = -y$. The equation is elliptic for $y < 0$, parabolic on $y = 0$, and hyperbolic for $y > 0$. The line $y = 0$ is a characteristic, representing a transition between different physical regimes. Mixed-type equations model transonic flow, where the fluid transitions between subsonic (elliptic) and supersonic (hyperbolic) regimes. The parabolic transition occurs at the sonic line, where the Mach number equals one.</p>
                    </details>
                </details>

                <details>
                    <summary>Challenge 2 [★★★] Shock Formation in Nonlinear Waves</summary>
                    <p>For the inviscid Burgers equation $u_t + u u_x = 0$ with initial data $u(x,0) = \sin(x)$ on $[0, 2\pi]$, determine the shock formation time and location. Show that the solution becomes multivalued, and explain why this necessitates weak solutions.</p>
                    <details>
                        <summary>Solution</summary>
                        <p>The characteristics are $x = x_0 + \sin(x_0) t$. The shock forms when characteristics intersect, which occurs when $\partial x / \partial x_0 = 1 + t \cos(x_0) = 0$, giving $t = -1/\cos(x_0)$. The minimum occurs at $x_0 = \pi$, yielding shock time $t_s = 1$. The shock location is $x_s = \pi + t$. After $t = 1$, the solution becomes multivalued because different characteristics carrying different values of $u$ intersect. This multivaluedness violates the classical notion of a function, necessitating weak solutions that allow discontinuities satisfying the Rankine-Hugoniot jump conditions.</p>
                    </details>
                </details>

                <details>
                    <summary>Challenge 3 [★★★] Convergence of Eigenfunction Expansions</summary>
                    <p>Construct an example of a continuous function on $[0, \pi]$ whose Fourier sine series diverges at a point. Discuss the relationship between pointwise convergence, $L^2$ convergence, and uniform convergence for eigenfunction expansions.</p>
                    <details>
                        <summary>Solution</summary>
                        <p>There exist continuous functions (constructed via the principle of condensation of singularities) whose Fourier series diverge at specific points. However, by Carleson's theorem, the Fourier series of an $L^2$ function converges almost everywhere. The key distinction is: $L^2$ convergence is guaranteed by completeness of the eigenfunctions, pointwise convergence requires additional regularity (piecewise $C^1$ by Dirichlet's theorem), and uniform convergence requires even more (continuity and periodicity). The Gibbs phenomenon shows that even for piecewise smooth functions, pointwise convergence fails at jumps, though $L^2$ convergence still holds.</p>
                    </details>
                </details>

            </section>

            <!-- FINAL CLIFFHANGER -->
            <div class="cliffhanger final">
                <p>We have mastered separation of variables, eigenfunction expansions, and the method of characteristics. But this mastery exposes its own limitations. When nonlinearity enters, characteristics intersect and shocks form. When boundaries are irregular, separation fails. When initial data is discontinuous, eigenfunction expansions converge only in $L^2$, not pointwise. The classical framework is too narrow. In the next section, we abandon explicit solutions entirely and embrace asymptotic methods that capture the essential behavior in limits—even when exact solutions are impossible.</p>
            </div>

            <!-- REFERENCES -->
            <section class="references">
                <h2>Key References</h2>
                <ul>
                    <li>Evans, L. C. (2010). <em>Partial Differential Equations</em>, 2nd ed.</li>
                    <li>Strauss, W. A. (2008). <em>Partial Differential Equations: An Introduction</em>, 2nd ed.</li>
                    <li>Folland, G. B. (1995). <em>Introduction to Partial Differential Equations</em>, 2nd ed.</li>
                    <li>Courant, R. & Hilbert, D. (1989). <em>Methods of Mathematical Physics, Vol. II</em>.</li>
                </ul>
            </section>

            <!-- NAVIGATION -->
            <nav class="navigation">
                <hr>
                <ul>
                    <li>Previous → <a href="/diffequations/chapter-01/01-3-integral-transforms/">Section 1.3: Integral Transforms</a></li>
                    <li>Next → <a href="/diffequations/chapter-01/01-5-asymptotic-analysis/">Section 1.5: Asymptotic Analysis</a></li>
                    <li><a href="/diffequations/chapter-01/">Chapter 1 Contents</a></li>
                    <li><a href="/diffequations/">Full Table of Contents</a></li>
                </ul>
            </nav>

        </article>
    </main>

    <!-- Python/Plotly Widget System - Load after content -->
    <script>
        // Lazy load Plotly.js after page is fully loaded
        window.addEventListener('load', function () {
            var plotlyScript = document.createElement('script');
            plotlyScript.src = 'https://cdn.plot.ly/plotly-2.27.0.min.js';
            plotlyScript.charset = 'utf-8';
            plotlyScript.async = true;
            plotlyScript.onload = function () {
                console.log('Plotly.js loaded successfully');
            };
            plotlyScript.onerror = function () {
                console.error('Failed to load Plotly.js');
            };
            document.body.appendChild(plotlyScript);
        });
    </script>

    <!-- Widget Engine Scripts - Load with defer to not block rendering -->
    <script defer src="/diffequations/js/textbook-engine.js"></script>
    <script defer src="/diffequations/js/widget-engine.js"></script>
</body>

</html>
