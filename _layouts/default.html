<!DOCTYPE html>
<html>
  {% include head.html %}
  <body class="animated fadeIn{% if page.class %} {{ page.class }}{% endif %}">
    {% include header.html %}
    <div class="container">
      <!-- Theme requires these SVG layers for animated background -->
      <div id="background-div">
        <svg id="background-svg">
          <defs>
            <lineargradient id="Gradient1" x1="0" x2="0" y1="0" y2="1">
              <stop stop-opacity="0" class="bgColor1" offset="0%" />
              <stop stop-opacity="1" class="bgColor2" offset="100%" />
            </lineargradient>
          </defs>
          <!-- Theme's main.js expects these layers for animated strips -->
          <g id="bg-layer1"></g>
          <g id="bg-layer2"></g>
          <g id="bg-layer3"></g>
          <g id="bg-layer4"></g>
        </svg>
      </div>
      <div class="content-div">
        {{ content }}
      </div>
    </div>
    {% include footer.html %}
    <!-- Custom footer with only copyright - sticky to bottom -->
    <footer class="site-footer">
      <p>Copyright Â© 2025. All rights reserved.</p>
    </footer>

    <!-- jetbundle Gauge Theme JavaScript - Minimal enhancement -->
    <script>
      // Minimal enhancements - theme's main.js handles initialization
      (function() {
        'use strict';

        // Remove theme's sidebar/toolbar navigation - AGGRESSIVE
        function removeThemeNavigation() {
          // Remove sidebars and toolbars - comprehensive selectors
          const selectors = [
            'aside',
            '.sidebar',
            '.toolbar',
            'nav.toolbar',
            '.side-nav',
            '.nav-sidebar',
            '#sidebar',
            '#toolbar',
            '[class*="toolbar"]',
            '[class*="sidebar"]',
            '[id*="toolbar"]',
            '[id*="sidebar"]'
          ];

          selectors.forEach(selector => {
            try {
              const elements = document.querySelectorAll(selector);
              elements.forEach(el => {
                // Don't remove our custom header or its children
                const inOurHeader = el.closest('header.site-header') ||
                                    el.closest('.navbar-container') ||
                                    el.closest('.navbar-menu') ||
                                    el.classList.contains('navbar-container') ||
                                    el.classList.contains('navbar-menu') ||
                                    el.classList.contains('site-navbar') ||
                                    el.classList.contains('navbar-link') ||
                                    el.classList.contains('navbar-brand');

                if (!inOurHeader) {
                  // Hide and remove
                  el.style.display = 'none';
                  el.style.visibility = 'hidden';
                  el.style.opacity = '0';
                  el.style.width = '0';
                  el.style.height = '0';
                  el.style.overflow = 'hidden';
                  el.style.position = 'absolute';
                  el.style.left = '-9999px';
                  el.remove();
                }
              });
            } catch (e) {
              // Ignore errors
            }
          });

          // Also remove any navigation lists
          try {
            const navLists = document.querySelectorAll('ul, ol');
            navLists.forEach(list => {
              if (!list.closest('header.site-header') && !list.closest('.navbar-container')) {
                // Check if it contains navigation links
                const links = list.querySelectorAll('a');
                let isNav = false;
                links.forEach(link => {
                  const text = link.textContent.trim();
                  if (text === 'About' || text === 'Resources' || text === 'Blog' ||
                      text === 'Community' || text === 'Home' || text.includes('Home') ||
                      text.includes('jetbundle')) {
                    if (!link.closest('header.site-header')) {
                      isNav = true;
                    }
                  }
                });
                if (isNav) {
                  list.style.display = 'none';
                  list.remove();
                }
              }
            });
          } catch (e) {
            // Ignore
          }

          // Remove "jetbundleHome" or "Home" text links and any unwanted navigation
          try {
            const allLinks = document.querySelectorAll('a');
            allLinks.forEach(link => {
              const text = link.textContent.trim();
              const href = link.getAttribute('href') || '';
              // Remove if it says "Home", "jetbundleHome", or is a home link that's not our brand
              if ((text === 'Home' || text.includes('jetbundleHome') || text === 'jetbundleHome' ||
                   text.toLowerCase() === 'home') &&
                  !link.classList.contains('navbar-brand') &&
                  !link.closest('header')) {
                // Remove the link and its parent if it's in a list item
                const parent = link.parentElement;
                if (parent && (parent.tagName === 'LI' || parent.classList.contains('nav-item'))) {
                  parent.remove();
                } else {
                  link.remove();
                }
              }
            });

            // Also remove any text nodes containing "jetbundleHome"
            const walker = document.createTreeWalker(
              document.body,
              NodeFilter.SHOW_TEXT,
              null,
              false
            );
            let node;
            while (node = walker.nextNode()) {
              if (node.textContent.includes('jetbundleHome')) {
                node.parentElement?.remove();
              }
            }
          } catch (e) {
            // Ignore errors
          }

          // Remove any navigation outside our header
          try {
            const navs = document.querySelectorAll('nav, .toolbar, aside, ul.toolbar, .nav-list');
            navs.forEach(nav => {
              // Skip our custom header
              if (!nav.closest('header') &&
                  !nav.classList.contains('navbar-container') &&
                  !nav.classList.contains('navbar-menu') &&
                  !nav.closest('.navbar-container')) {
                nav.style.display = 'none';
                nav.style.visibility = 'hidden';
                nav.remove();
              }
            });

            // Remove any list items that are navigation items
            const listItems = document.querySelectorAll('li');
            listItems.forEach(li => {
              const link = li.querySelector('a');
              if (link && !link.closest('header')) {
                const text = link.textContent.trim();
                // If it's a navigation link (About, Resources, Blog, Community, Home)
                if (text === 'About' || text === 'Resources' || text === 'Blog' ||
                    text === 'Community' || text === 'Home' || text.includes('Home')) {
                  // Only remove if it's not in our header
                  if (!link.closest('header') && !link.classList.contains('navbar-link')) {
                    li.remove();
                  }
                }
              }
            });
          } catch (e) {
            // Ignore errors
          }

          // Remove any elements with "jetbundleHome" in their text or ID
          try {
            const allElements = document.querySelectorAll('*');
            allElements.forEach(el => {
              const text = el.textContent || '';
              const id = el.id || '';
              const className = el.className || '';
              if ((text.includes('jetbundleHome') || id.includes('jetbundleHome') ||
                   className.includes('jetbundleHome')) && !el.closest('header')) {
                el.remove();
              }
            });
          } catch (e) {
            // Ignore errors
          }

          // Remove theme footer social links
          try {
            const footerLinks = document.querySelectorAll('footer a');
            footerLinks.forEach(link => {
              const href = link.getAttribute('href') || '';
              const text = link.textContent.trim();
              // Remove social media links
              if (href.includes('github.com') || href.includes('linkedin.com') ||
                  href.includes('twitter.com') || href.includes('facebook.com') ||
                  link.querySelector('.fa-github') || link.querySelector('.fa-linkedin') ||
                  link.querySelector('.fa-twitter') || link.querySelector('.fa-facebook')) {
                link.remove();
              }
            });

            // Remove social icons
            const socialIcons = document.querySelectorAll('footer .fa, footer .icon, footer i');
            socialIcons.forEach(icon => {
              icon.remove();
            });

            // Remove social link containers
            const socialContainers = document.querySelectorAll('footer .social, footer .social-links');
            socialContainers.forEach(container => {
              container.remove();
            });
          } catch (e) {
            // Ignore errors
          }
        }

        // Wait for theme's main.js to initialize
        function enhanceTheme() {
          // Remove theme navigation immediately
          removeThemeNavigation();

          // Also remove after a delay (theme might add it dynamically)
          setTimeout(removeThemeNavigation, 100);
          setTimeout(removeThemeNavigation, 500);
          setTimeout(removeThemeNavigation, 1000);

          // Only apply SVG gradient overrides after theme initializes
          setTimeout(function() {
            try {
              const svg = document.getElementById('background-svg');
              if (svg) {
                const stops = svg.querySelectorAll('stop.bgColor1, stop.bgColor2');
                stops.forEach(stop => {
                  if (stop.classList.contains('bgColor1')) {
                    stop.setAttribute('stop-color', '#0b0e17');
                  } else if (stop.classList.contains('bgColor2')) {
                    stop.setAttribute('stop-color', '#0a0d14');
                  }
                });
              }
            } catch (e) {
              // Silently fail
            }
          }, 600); // Wait for theme's setTimeout(updateBackground, 500)
        }

        // Initialize after DOM and scripts are ready
        if (document.readyState === 'loading') {
          document.addEventListener('DOMContentLoaded', enhanceTheme);
        } else {
          enhanceTheme();
        }

        // Also run on load (theme might add navigation after DOMContentLoaded)
        window.addEventListener('load', function() {
          setTimeout(removeThemeNavigation, 100);
          setTimeout(removeThemeNavigation, 500);
        });

        // Watch for dynamically added elements (throttled to avoid performance issues)
        if (window.MutationObserver) {
          let timeout;
          const observer = new MutationObserver(function(mutations) {
            clearTimeout(timeout);
            timeout = setTimeout(function() {
              removeThemeNavigation();
            }, 100);
          });
          observer.observe(document.body, {
            childList: true,
            subtree: true
          });
        }

        // Aggressive removal - run periodically to catch anything that slips through
        setInterval(function() {
          removeThemeNavigation();
        }, 2000);

        // Lightweight cursor trail - only if user moves mouse
        let trailInit = false;
        let trailActive = false;
        const trailLength = 8;
        let container = null;
        let animFrame = null;
        let mx = 0, my = 0;
        let lastMove = 0;
        const trail = [];

        function initTrail() {
          if (trailInit) return;
          trailInit = true;

          container = document.createElement('div');
          container.id = 'mouse-trail-container';
          container.style.cssText = 'position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:99999;';
          document.body.appendChild(container);

          for (let i = 0; i < trailLength; i++) {
            const p = document.createElement('div');
            const size = Math.max(2, 4 - i * 0.15);
            const opacity = Math.max(0, 0.8 - i * 0.1);
            p.style.cssText = `position:absolute;width:${size}px;height:${size}px;background:radial-gradient(circle,rgba(255,107,53,${opacity})0%,rgba(14,165,233,${opacity*0.8})50%,transparent 100%);border-radius:50%;pointer-events:none;opacity:0;will-change:transform,opacity;transition:opacity 0.1s;`;
            container.appendChild(p);
            trail.push({el:p,x:0,y:0,op:0});
          }
        }

        function startTrail() {
          if (trailActive || !trailInit) return;
          trailActive = true;
          lastMove = Date.now();

          function animate() {
            if (!trailActive) {
              animFrame = null;
              return;
            }

            const now = Date.now();
            if (now - lastMove > 1000) {
              let allInvisible = true;
              trail.forEach(p => {
                p.op = Math.max(0, p.op - 0.3);
                p.el.style.opacity = p.op;
                p.el.style.transform = `translate(${p.x}px,${p.y}px)`;
                if (p.op > 0.01) allInvisible = false;
              });
              if (allInvisible) {
                trailActive = false;
                animFrame = null;
                return;
              }
            } else {
              trail.forEach((p,i)=>{
                if(i===0){
                  p.x=mx;
                  p.y=my;
                  p.op=1;
                } else{
                  const prev=trail[i-1];
                  const dx=prev.x-p.x;
                  const dy=prev.y-p.y;
                  const dist=Math.sqrt(dx*dx+dy*dy);
                  if(dist>2){
                    p.x+=dx*0.25;
                    p.y+=dy*0.25;
                  } else {
                    p.x=prev.x;
                    p.y=prev.y;
                  }
                  p.op=Math.max(0,p.op-0.08);
                }
                p.el.style.transform = `translate(${p.x}px,${p.y}px)`;
                p.el.style.opacity = p.op;
              });
            }
            animFrame = requestAnimationFrame(animate);
          }
          animFrame = requestAnimationFrame(animate);
        }

        // Lazy load trail only on mouse move
        document.addEventListener('mousemove', function(e) {
          mx = e.clientX;
          my = e.clientY;
          lastMove = Date.now();
          if (!trailInit) {
            if (window.requestIdleCallback) {
              requestIdleCallback(initTrail, { timeout: 200 });
            } else {
              setTimeout(initTrail, 200);
            }
          }
          if (trailInit && !trailActive) {
            startTrail();
          }
        }, { passive: true });
      })();
    </script>
  </body>
</html>
