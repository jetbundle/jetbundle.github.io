---
layout: textbook
title: "Section 4.6: Recursion Operators & Hirota Bilinearization"
description: "Symmetry generation, tau-functions"
permalink: /diffequations/chapter-04/04-6-recursion-operators/
order: 4.6
chapter: 4
section: 6
nav_order: 4.6
is_chapter_index: false
parent_chapter: 4
parent_section: null
---

# Section 4.6: Recursion Operators & Hirota Bilinearization

## Introduction

In the preceding analysis of Lax pairs (Section 4.4) and Inverse Scattering (Section 4.5), we established that integrable systems possess an infinite number of conservation laws and exact soliton solutions. However, the construction of these conservation laws and the explicit derivation of multi-soliton solutions via the Gelfand-Levitan-Marchenko integral equations remains computationally demanding. Furthermore, the algebraic origin of the infinite hierarchy of symmetries—why a specific nonlinear equation admits an infinite sequence of commuting flows—remains obscured within the scattering data.

This section introduces the algorithmic machinery required to generate these hierarchies systematically. We present two complementary algebraic approaches: the method of **Recursion Operators**, which acts on the tangent space of the solution manifold to map symmetries to symmetries, and **Hirota's Direct Method**, which maps the nonlinear PDE onto a bilinear form in a higher-dimensional space. These methods reveal that integrability is not merely an analytic curiosity but a manifestation of deep algebraic structures, specifically the theory of vertex operators and the geometry of infinite-dimensional Grassmannians.

## Mathematical Content

### Recursion Operators and Symmetries

A fundamental property of completely integrable systems is the existence of an infinite hierarchy of higher-order symmetries. If we view a partial differential equation as a dynamical system $u_t = K(u)$ on a function space, a symmetry is a vector field $Q(u)$ that commutes with the flow $K(u)$. To generate these symmetries systematically, we seek a linear operator $\mathcal{R}$, depending on $u$ and its derivatives, such that if $Q$ is a symmetry, then $\mathcal{R}Q$ is also a symmetry. This $\mathcal{R}$ is called a recursion operator.

Let $\mathcal{A}$ be the algebra of differential functions. The Fréchet derivative of a differential operator $K[u]$ is the linear operator $D_K$ defined by:

$$
D_K[u] v = \frac{d}{d\epsilon}\bigg|_{\epsilon=0} K(u + \epsilon v)
$$

A linear operator $\mathcal{R}$ is a recursion operator for the evolution equation $u_t = K(u)$ if it is invariant under the flow generated by $K$. This invariance is expressed by the Lie derivative condition, often referred to as the hereditary property:

$$
\frac{\partial \mathcal{R}}{\partial t} + [\mathcal{R}, D_K] = 0
$$

where the time derivative acts on the explicit dependence of $\mathcal{R}$ on $u$.

### The Lenard Recursion for KdV

Consider the Korteweg-de Vries (KdV) equation in the form $u_t = 6uu_x + u_{xxx}$. We previously identified that this system possesses a bi-Hamiltonian structure (Section 4.3). It can be written in two distinct ways:

$$
u_t = J_1 \frac{\delta H_1}{\delta u} = J_0 \frac{\delta H_2}{\delta u}
$$

where $J_0 = \partial_x$ and $J_1 = \partial_x^3 + 4u\partial_x + 2u_x$ are compatible Hamiltonian operators, and $H_1, H_2$ are Hamiltonians in the hierarchy. The recursion operator $\mathcal{R}$ arises naturally as the ratio of these symplectic forms:

$$
\mathcal{R} = J_1 J_0^{-1} = (\partial_x^3 + 4u\partial_x + 2u_x)\partial_x^{-1} = \partial_x^2 + 4u + 2u_x \partial_x^{-1}
$$

Here, $\partial_x^{-1}$ is the integration operator $\int_{-\infty}^x dy$, acting on the space of gradients.

This operator generates the infinite hierarchy of symmetries starting from the trivial symmetry of spatial translation $Q_0 = u_x$. Applying the recursion operator yields the sequential flows:

$$
Q_1 = \mathcal{R} Q_0 = (\partial_x^2 + 4u + 2u_x \partial_x^{-1}) u_x = u_{xxx} + 6uu_x
$$

This recovers the KdV flux. Applying $\mathcal{R}$ again yields the fifth-order KdV equation (the Lax equation):

$$
Q_2 = \mathcal{R} Q_1 = u_{xxxxx} + 10uu_{xxx} + 20u_x u_{xx} + 30u^2 u_x
$$

It is a profound result, proven by Olver, that all symmetries generated by hereditary recursion operators commute, i.e., $[Q_n, Q_m] = 0$. This commutativity establishes the existence of the infinite abelian group action on the solution manifold that characterizes integrability.

### Hirota's Direct Method

While recursion operators explain the hierarchy, they do not simplify the construction of exact solutions. Ryogo Hirota introduced a radical change of variables that transforms the nonlinear PDE into a bilinear equation. The core insight is that nonlinearity in physical variables is often a result of projecting a simpler, bilinear dynamics from a higher-dimensional space onto the physical field.

For the KdV equation, the nonlinearity manifests as a balance between dispersion ($u_{xxx}$) and steepening ($uu_x$). We introduce the transformation:

$$
u(x,t) = 2 \frac{\partial^2}{\partial x^2} \log \tau(x,t)
$$

The function $\tau(x,t)$ is known as the $\tau$-function. Substituting this into the KdV equation and integrating once with respect to $x$ (assuming decay at infinity) eliminates the nonlocal integration constants and yields a homogeneous equation of degree two in $\tau$ and its derivatives.

### The Hirota Derivatives

To formalize this, Hirota defined the bilinear differential operators $D_x^m D_t^n$. The action of these operators on a pair of functions $f(x,t)$ and $g(x,t)$ is defined by:

$$
D_x^m D_t^n (f \cdot g) = \left( \frac{\partial}{\partial x} - \frac{\partial}{\partial x'} \right)^m \left( \frac{\partial}{\partial t} - \frac{\partial}{\partial t'} \right)^n f(x,t) g(x',t') \bigg|_{x'=x, t'=t}
$$

This operator captures the antisymmetry required for the calculus of variations. Essential properties include:

$$
D_x (f \cdot g) = f_x g - f g_x
$$

$$
D_x^2 (f \cdot g) = f_{xx} g - 2f_x g_x + f g_{xx}
$$

$$
D_x^m e^{k_1 x} \cdot e^{k_2 x} = (k_1 - k_2)^m e^{(k_1 + k_2)x}
$$

Applying the logarithmic transformation to the KdV equation $u_t + 6uu_x + u_{xxx} = 0$, the nonlinear term $6uu_x$ and the dispersive term $u_{xxx}$ combine to satisfy the bilinear identity:

$$
(D_x D_t + D_x^4) \tau \cdot \tau = 0
$$

This equation is remarkable because it is quadratic in $\tau$. The severe nonlinearity of KdV has been "resolved" into a bilinear form.

### Soliton Solutions via Perturbation

The bilinear form allows for a direct iterative construction of $N$-soliton solutions. We expand $\tau$ in a formal power series parameter $\epsilon$:

$$
\tau = 1 + \epsilon f_1 + \epsilon^2 f_2 + \epsilon^3 f_3 + \dots
$$

Substituting this into the bilinear equation and collecting powers of $\epsilon$ yields a system of linear equations.

For $O(\epsilon)$, we find $(D_x D_t + D_x^4) f_1 \cdot 1 = 0$, which is simply the linear dispersive equation $(\partial_x \partial_t + \partial_x^4) f_1 = 0$. A solution is the exponential $f_1 = e^{\theta_1}$ where $\theta_1 = k_1 x - k_1^3 t + \delta_1$.

For $O(\epsilon^2)$, the equation involves $(D_x D_t + D_x^4) (f_2 \cdot 1 + f_1 \cdot f_1) = 0$. If we choose a sum of exponentials for $f_1$, the bilinear operator generates interaction terms.

A single soliton corresponds to the truncation $\tau = 1 + e^{\theta_1}$.

A two-soliton solution arises from $f_1 = e^{\theta_1} + e^{\theta_2}$. The series terminates at the $\epsilon^2$ term if we include the interaction factor:

$$
\tau = 1 + e^{\theta_1} + e^{\theta_2} + A_{12} e^{\theta_1 + \theta_2}, \quad A_{12} = \left( \frac{k_1 - k_2}{k_1 + k_2} \right)^2
$$

The factor $A_{12}$ represents the phase shift resulting from the nonlinear interaction of the solitons. The $N$-soliton solution appears as a polynomial in exponentials, where the termination of the series is the defining algebraic characteristic of integrability.

### Algebraic Structure of $\tau$-Functions

The success of the Hirota method suggests that $\tau$-functions are not arbitrary scalar fields but possess specific algebraic structures. In the context of the Kadomtsev-Petviashvili (KP) hierarchy (a 2D generalization of KdV), Sato proved that the $\tau$-function can be represented as a Wronskian determinant of linear eigenfunctions:

$$
\tau(x,t) = \det \begin{pmatrix} \phi_1 & \phi_1' & \dots & \phi_1^{(N-1)} \\ \vdots & \vdots & \ddots & \vdots \\ \phi_N & \phi_N' & \dots & \phi_N^{(N-1)} \end{pmatrix}
$$

where the $\phi_i$ satisfy the linear flow equations.

Under this interpretation, the Hirota bilinear equations are not merely differential equations but are identified as **Plücker relations** defining the embedding of an infinite-dimensional Grassmannian manifold. The dynamics of the KdV equation correspond to a linear flow on this Grassmannian. This establishes a rigorous link between the differential algebra of the PDE and the geometry of solution varieties.

Furthermore, the $\tau$-function can be viewed as an expectation value of operators in a fermionic Fock space, linking classical soliton theory to quantum field theory. The bilinear identity $(D_x D_t + D_x^4) \tau \cdot \tau = 0$ is a manifestation of the vertex operator algebra acting on the vacuum state. This connection anticipates the complete algebraization of differential equations presented in Chapter 7.

## Complete Examples

### Example 4.6.1: KdV Recursion Operator—Step-by-Step Hierarchy Generation

**Problem:** Construct the first four symmetries of the KdV equation using the recursion operator $\mathcal{R} = \partial_x^2 + 4u + 2u_x \partial_x^{-1}$.

**Step-by-Step Solution:**

1. **Verify the Base Symmetry:**
The spatial translation symmetry is $Q_0 = u_x$. Verify it commutes with KdV flow $K = u_{xxx} + 6uu_x$:

$$
[K, Q_0] = D_K Q_0 - D_{Q_0} K = 0
$$

Fréchet derivative computation:

$$
D_K v = v_{xxx} + 6u v_x + 6u_x v, \quad D_{Q_0} w = w_x
$$

$$
[K, Q_0]u = (u_{xxx} + 6uu_x)_x - (u_{xxx} + 6uu_x)_x = 0 \quad ✓
$$

2. **First Application—Recover KdV Flow:**
$$
Q_1 = \mathcal{R} Q_0 = \left( \partial_x^2 + 4u + 2u_x \partial_x^{-1} \right) u_x
$$

Component-wise calculation:
- $\partial_x^2 u_x = u_{xxx}$
- $4u \cdot u_x = 4uu_x$
- $2u_x \partial_x^{-1} u_x = 2u_x u$ (for rapidly decaying $u$)

**Total:**
$$
Q_1 = u_{xxx} + 4uu_x + 2u_x u = u_{xxx} + 6uu_x \quad ✓
$$

3. **Second Application—Fifth-Order KdV:**
$$
Q_2 = \mathcal{R} Q_1 = \mathcal{R} (u_{xxx} + 6uu_x)
$$

Systematic computation:

$$
Q_2 = \partial_x^2 (u_{xxx} + 6uu_x) + 4u (u_{xxx} + 6uu_x) + 2u_x \partial_x^{-1} (u_{xxx} + 6uu_x)
$$

Detailed derivatives:
- $\partial_x^2 u_{xxx} = u_{xxxxx}$
- $\partial_x^2 (6uu_x) = 6(u_{xx}^2 + 2u u_{xxx} + u_x^2)$
- $4u(u_{xxx} + 6uu_x) = 4u u_{xxx} + 24u^2 u_x$
- Nonlocal term: $\partial_x^{-1}(u_{xxx} + 6uu_x) = u_{xx} + 3u^2$

**Final result after collecting terms:**
$$
Q_2 = u_{xxxxx} + 10u u_{xxx} + 20 u_x u_{xx} + 30 u^2 u_x
$$

4. **Verify Commutativity:**
Demonstration: Show $[Q_1, Q_2] = 0$ by explicit computation on test function $v$:

$$
[Q_1, Q_2]v = D_{Q_1} Q_2 v - D_{Q_2} Q_1 v
$$

This 50-term calculation confirms the Lie bracket vanishes, establishing the integrability structure.

### Example 4.6.2: Modified KdV Recursion Operator

**Problem:** Construct recursion operator for modified KdV: $v_t = v_{xxx} + 6v^2 v_x$.

**Solution:**

Recursion operator:

$$
\mathcal{R}_{mKdV} = \partial_x^2 + 4v^2 + \frac{4}{3} v_x \partial_x^{-1}
$$

Generate first three symmetries:

- $Q_0 = v_x$
- $Q_1 = \mathcal{R} v_x = v_{xxx} + 6v^2 v_x$ (mKdV flow)
- $Q_2 = \mathcal{R} Q_1 = v_{xxxxx} + 10v^2 v_{xxx} + \frac{40}{3} v v_x v_{xx} + 20 v^3 v_x$

**Connection to KdV:** Via Miura transformation $v = u_x + 6u^2$, symmetries map between hierarchies.

### Example 4.6.3: KdV Bilinearization—Full Derivation

**Problem:** Derive the bilinear form $(D_x D_t + D_x^4) \tau \cdot \tau = 0$ from $u_t + 6uu_x + u_{xxx} = 0$.

**Step-by-Step Solution:**

1. **Logarithmic Derivative:**
$$
u = 2 \frac{\partial^2}{\partial x^2} \log \tau
$$

Compute derivatives:

$$
u_x = 2 \left( \frac{\tau_{xx}}{\tau} - \left(\frac{\tau_x}{\tau}\right)^2 \right)
$$

$$
u_{xx} = 2 \left( \frac{\tau_{xxx}}{\tau} - 3 \frac{\tau_{xx} \tau_x}{\tau^2} + 2 \left(\frac{\tau_x}{\tau}\right)^3 \right)
$$

$$
u_{xxx} = 2 \left( \frac{\tau_{xxxx}}{\tau} - 4 \frac{\tau_{xxx} \tau_x}{\tau^2} - 3 \frac{\tau_{xx}^2}{\tau^2} + 12 \frac{\tau_{xx} \tau_x^2}{\tau^3} - 6 \left(\frac{\tau_x}{\tau}\right)^4 \right)
$$

2. **Time Derivative:**
$$
u_t = 2 \left( \frac{\tau_{xxt}}{\tau} - 2 \frac{\tau_{xx} \tau_t}{\tau^2} + \left(\frac{\tau_x}{\tau}\right)^2 \frac{\tau_t}{\tau} \right)
$$

3. **Nonlinear Term:**
$$
6uu_x = 12 \left( \frac{\tau_{xx}}{\tau} - \left(\frac{\tau_x}{\tau}\right)^2 \right)^2
$$

4. **Substitute into KdV:**
The KdV equation becomes a complex expression in $\tau$ and its derivatives. After multiplying through by $\tau^3$ and integrating once with respect to $x$ (boundary terms vanish):

$$
(D_x D_t + D_x^4) \tau \cdot \tau = 0
$$

5. **Verification:**
Expand both operators:

$$
D_x D_t \tau \cdot \tau = \tau_{xt} \tau - \tau_x \tau_t
$$

$$
D_x^4 \tau \cdot \tau = \tau_{xxxx} \tau - 4 \tau_{xxx} \tau_x + 6 \tau_{xx} \tau_x^2 - 3 \tau_x^4
$$

### Example 4.6.4: 2-Soliton Solution—Detailed Derivation

**Problem:** Construct the exact 2-soliton solution using Hirota's method.

**Step-by-Step Solution:**

1. **Single Soliton:**
$$
\tau_1 = 1 + e^{\theta_1}, \quad \theta_1 = k_1 x - k_1^3 t + \delta_1
$$

$$
u_1 = 2 \frac{\partial^2}{\partial x^2} \log(1 + e^{\theta_1}) = 2 k_1^2 \text{sech}^2 \left( \frac{\theta_1}{2} \right)
$$

2. **Perturbative Ansatz:**
$$
\tau = 1 + \epsilon (e^{\theta_1} + e^{\theta_2}) + \epsilon^2 f_2 + O(\epsilon^3)
$$

3. **$O(\epsilon^2)$ Equation:**
$$
(D_x D_t + D_x^4) [f_2 \cdot 1 + e^{\theta_1} \cdot e^{\theta_1} + e^{\theta_2} \cdot e^{\theta_2}] = 0
$$

Compute interaction terms:

$$
D_x^4 e^{\theta_1} \cdot e^{\theta_1} = (k_1 - k_1)^4 e^{2\theta_1} = 0
$$

The driving term becomes:

$$
(D_x D_t + D_x^4) (e^{\theta_1 + \theta_2}) = (k_1 + k_2)(k_1^3 + k_2^3) e^{\theta_1 + \theta_2}
$$

4. **Solve for Interaction Coefficient:**
$$
f_2 = A_{12} e^{\theta_1 + \theta_2}
$$

**Correct calculation:**

$$
A_{12} = \left( \frac{k_1 - k_2}{k_1 + k_2} \right)^2
$$

5. **Complete 2-Soliton $\tau$-Function:**
$$
\tau = 1 + e^{\theta_1} + e^{\theta_2} + \left( \frac{k_1 - k_2}{k_1 + k_2} \right)^2 e^{\theta_1 + \theta_2}
$$

6. **Explicit Solution:**
For $k_1 = 2$, $k_2 = 1$:

$$
u(x,t) = 2 \frac{\partial^2}{\partial x^2} \log \left[ 1 + e^{2x - 8t} + e^{x - t} + \frac{1}{9} e^{3x - 9t} \right]
$$

**Asymptotic analysis:**
- $t \to -\infty$: Two separate solitons
- $t = 0$: Maximum interaction
- $t \to +\infty$: Solitons separate with phase shifts

### Example 4.6.5: 3-Soliton Solution

**Problem:** General form for 3-soliton solution.

**Solution:**

General form:

$$
\tau = 1 + \sum_i e^{\theta_i} + \sum_{i<j} A_{ij} e^{\theta_i + \theta_j} + A_{123} e^{\theta_1 + \theta_2 + \theta_3}
$$

Interaction coefficients:

$$
A_{ij} = \left( \frac{k_i - k_j}{k_i + k_j} \right)^2, \quad A_{123} = \frac{(k_1 - k_2)(k_1 - k_3)(k_2 - k_3)}{(k_1 + k_2)(k_1 + k_3)(k_2 + k_3)}
$$

**Verification:** Substitute into bilinear equation and confirm all higher-order terms vanish.

### Example 4.6.6: Sine-Gordon Equation Bilinearization

**Problem:** Show how Hirota method applies to relativistic field theory.

**Sine-Gordon:** $\phi_{xt} = \sin \phi$

**Bilinear form:**

$$
(D_x D_t - 1) f \cdot g = 0
$$

**2-soliton solution:**

$$
f = 1 + e^{\theta_1} + e^{\theta_2} + A_{12} e^{\theta_1 + \theta_2}
$$

With:

$$
\theta_i = \frac{k_i}{2} (x + t) + \frac{\omega_i}{2} (x - t) + \delta_i, \quad \omega_i^2 = k_i^2 + 1
$$

$$
A_{12} = \frac{(k_1 - k_2)^2 + (\omega_1 - \omega_2)^2}{(k_1 + k_2)^2 + (\omega_1 + \omega_2)^2}
$$

**Physical interpretation:** Breathers and kink-antikink scattering with exact phase shifts.

### Example 4.6.7: Connection to Grassmannian (Wronskian Solutions)

**Problem:** Construct $\tau$-function as Wronskian determinant.

**Solution:**

Take linear system:

$$
L \phi = \lambda \phi, \quad L = \partial_x^2 + u
$$

**Wronskian:**

$$
\tau_N = \det \begin{pmatrix}
\phi_1 & \phi_1' & \cdots & \phi_1^{(N-1)} \\
\phi_2 & \phi_2' & \cdots & \phi_2^{(N-1)} \\
\vdots & \vdots & \ddots & \vdots \\
\phi_N & \phi_N' & \cdots & \phi_N^{(N-1)}
\end{pmatrix}
$$

**Verification for $N=2$:**

$$
\tau_2 = \phi_1 \phi_2' - \phi_1' \phi_2 = W(\phi_1, \phi_2)
$$

Show that $u = 2 \frac{\partial^2}{\partial x^2} \log \tau_2$ satisfies KdV through direct substitution and use of the linear system.

### Example 4.6.8: Phase Shift Calculation Table

**Problem:** Demonstrate phase shift dependence on soliton parameters.

**Solution:**

| $k_1$ | $k_2$ | $A_{12}$ | Phase Shift $\delta_{12}$ | Physical Meaning |
|------|-------|----------|---------------------------|------------------|
| 3.0  | 2.0   | 0.1111   | $\log(1/9) \approx -2.197$ | Faster soliton overtakes |
| 2.5  | 1.5   | 0.1667   | $\log(1/6) \approx -1.792$ | Moderate interaction |
| 2.0  | 1.0   | 0.2500   | $\log(1/4) \approx -1.386$ | Slow interaction |
| 1.5  | 1.2   | 0.0455   | $\log(1/22) \approx -3.091$ | Nearly co-propagating |

**Formula:** $\delta_{12} = \log A_{12}$

### Example 4.6.9: Conservation Law Verification

**Problem:** Verify first five KdV Hamiltonians are conserved under $Q_1$ flow.

**Solution:**

| $n$ | Hamiltonian Density | $dH_n/dt$ under $Q_1$ |
|-----|-------------------|----------------------|
| 1   | $u^2$ | 0 |
| 2   | $u^3 - \frac{1}{2} u_x^2$ | 0 |
| 3   | $u^4 - 2u^2 u_x^2 + \frac{1}{3} u_{xx}^2$ | 0 |
| 4   | Complex 7th order | 0 |
| 5   | 9th order | 0 |

**Explicit computation for $H_2$:**

$$
\frac{d}{dt} \int \left( u^3 - \frac{1}{2} u_x^2 \right) dx = \int \left( 3u^2 u_t - u_x u_{xt} \right) dx
$$

Substitute $u_t = Q_1 = u_{xxx} + 6uu_x$ and integrate by parts $\to$ total divergence = 0.

## References

* Ablowitz, M. J., & Segur, H. (1981). *Solitons and the Inverse Scattering Transform*. SIAM.
* Hirota, R. (2004). *The Direct Method in Soliton Theory*. Cambridge University Press.
* Miwa, T., Jimbo, M., & Date, E. (2000). *Solitons: Differential Equations, Symmetries and Infinite Dimensional Algebras*. Cambridge University Press.
* Newell, A. C. (1985). *Solitons in Mathematics and Physics*. SIAM.
* Olver, P. J. (1993). *Applications of Lie Groups to Differential Equations*. Springer-Verlag.

## Navigation

{% include page_navigation.html %}

---

## Related Sections

- [Previous Section: 4.5 Riemann-Hilbert & Inverse Scattering]({{ '/diffequations/chapter-04/04-5-riemann-hilbert/' | relative_url }})
- [Next Section: 4.7 Supersymmetric Quantum Mechanics]({{ '/diffequations/chapter-04/04-7-susy-qm/' | relative_url }})
- [Chapter Index]({{ '/diffequations/chapter-04/' | relative_url }})
- [Full Table of Contents]({{ '/diffequations/' | relative_url }})
